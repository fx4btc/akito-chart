{"version":3,"sources":["flagrate/slider.ts"],"names":[],"mappings":"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","file":"slider.js","sourcesContent":["/*\r\n   Copyright 2016 Webnium\r\n\r\n   Licensed under the Apache License, Version 2.0 (the \"License\");\r\n   you may not use this file except in compliance with the License.\r\n   You may obtain a copy of the License at\r\n\r\n       http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n   Unless required by applicable law or agreed to in writing, software\r\n   distributed under the License is distributed on an \"AS IS\" BASIS,\r\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n   See the License for the specific language governing permissions and\r\n   limitations under the License.\r\n*/\r\n\"use strict\";\r\n\r\nimport { extendObject } from \"./util\";\r\nimport * as progress from \"./progress\";\r\n\r\n/*?\r\n    class flagrate.Slider\r\n\r\n    #### Events\r\n\r\n    * `change`: when the value is changed. (by flagrate.Progress)\r\n    * `slide` : when the slide by user.\r\n\r\n    #### Inheritance\r\n\r\n    * flagrate.Progress\r\n**/\r\nexport interface Slider extends Instance, progress.Progress { }\r\n\r\nexport interface Class {\r\n    new (option?: Option): Slider;\r\n    prototype: Instance;\r\n}\r\n\r\nexport interface Instance {\r\n    disable(): this;\r\n    enable(): this;\r\n    isEnabled(): boolean;\r\n\r\n    _onPointerDownHandler(e: PointerEvent): void;\r\n    _onTouchStartHandler(e: TouchEvent): void;\r\n    _slide(x: number, pos: number, type: \"pointer\" | \"touch\"): void;\r\n}\r\n\r\nexport interface Option extends progress.Option {\r\n    /** default is false. */\r\n    isDisabled?: boolean;\r\n}\r\n\r\n/*?\r\n    flagrate.createSlider(option)\r\n    new flagrate.Slider(option)\r\n    - option (Object) - options.\r\n**/\r\nfunction FSlider(opt: Option = {}) {\r\n\r\n    //create\r\n    const slider = new progress.Progress(opt) as Slider;\r\n    extendObject(slider, this);\r\n\r\n    slider.addClassName(\"flagrate-slider\");\r\n    if (slider.tabIndex === -1) {\r\n        slider.tabIndex = 0;\r\n    }\r\n\r\n    if (window.ontouchstart !== undefined) {\r\n        slider.addEventListener(\"touchstart\", slider._onTouchStartHandler.bind(slider));\r\n    }\r\n    if (navigator.pointerEnabled) {\r\n        slider.addEventListener(\"pointerdown\", slider._onPointerDownHandler.bind(slider));\r\n    } else if (navigator.msPointerEnabled) {\r\n        // deprecated on IE11\r\n        slider.addEventListener(\"MSPointerDown\", slider._onPointerDownHandler.bind(slider));\r\n    } else {\r\n        slider.addEventListener(\"mousedown\", slider._onPointerDownHandler.bind(slider));\r\n    }\r\n\r\n    if (opt.isDisabled) {\r\n        slider.disable();\r\n    }\r\n\r\n    return slider;\r\n}\r\n\r\nexport const Slider = FSlider as any as Class;\r\n\r\nexport function createSlider(option?: Option): Slider {\r\n    return new Slider(option);\r\n}\r\n\r\nSlider.prototype = {\r\n    disable() {\r\n\r\n        const slider = this as Slider;\r\n\r\n        slider.dataset[\"flagrateTabIndex\"] = slider.tabIndex.toString(10);\r\n        slider.removeAttribute(\"tabindex\");\r\n\r\n        return slider.addClassName(\"flagrate-disabled\");\r\n    },\r\n\r\n    enable() {\r\n\r\n        const slider = this as Slider;\r\n\r\n        const tabIndex = parseInt(slider.dataset[\"flagrateTabIndex\"]);\r\n        if (tabIndex !== -1) {\r\n            slider.tabIndex = tabIndex;\r\n        }\r\n\r\n        return slider.removeClassName(\"flagrate-disabled\");\r\n    },\r\n\r\n    isEnabled() {\r\n        return !this.hasClassName(\"flagrate-disabled\");\r\n    },\r\n\r\n    _onTouchStartHandler(e) {\r\n\r\n        if (!this.isEnabled()) {\r\n            return;\r\n        }\r\n\r\n        e.preventDefault();\r\n\r\n        this._slide(\r\n            e.touches[0].pageX - this.cumulativeOffset().left,\r\n            e.touches[0].clientX,\r\n            \"touch\"\r\n        );\r\n    },\r\n\r\n    _onPointerDownHandler(e) {\r\n\r\n        if (!this.isEnabled()) {\r\n            return;\r\n        }\r\n\r\n        e.preventDefault();\r\n\r\n        this._slide(\r\n            e.offsetX || e.layerX,\r\n            e.clientX,\r\n            \"pointer\"\r\n        );\r\n    },\r\n\r\n    _slide(x, pos, type) {\r\n\r\n        const slider = this as Slider;\r\n\r\n        const unitWidth = slider.getWidth() / slider.getMax();\r\n\r\n        const onMove = (e) => {\r\n\r\n            e.preventDefault();\r\n\r\n            if (e.touches && e.touches[0]) {\r\n                x = x + e.touches[0].clientX - pos;\r\n                pos = e.touches[0].clientX;\r\n            } else {\r\n                x = x + e.clientX - pos;\r\n                pos = e.clientX;\r\n            }\r\n\r\n            slider.setValue(Math.round(x / unitWidth));\r\n            slider.fire(\"slide\", { targetSlider: slider });\r\n        };\r\n\r\n        const onUp = (e) => {\r\n\r\n            e.preventDefault();\r\n\r\n            if (type === \"pointer\") {\r\n                if (navigator.pointerEnabled) {\r\n                    document.removeEventListener(\"pointermove\", onMove);\r\n                    document.removeEventListener(\"pointerup\", onUp);\r\n                } else if (navigator.msPointerEnabled) {\r\n                    document.removeEventListener(\"MSPointerUp\", onUp);\r\n                    document.removeEventListener(\"MSPointerMove\", onMove);\r\n                } else {\r\n                    document.removeEventListener(\"mousemove\", onMove);\r\n                    document.removeEventListener(\"mouseup\", onUp);\r\n                }\r\n            } else if (type === \"touch\") {\r\n                document.removeEventListener(\"touchmove\", onMove);\r\n                document.removeEventListener(\"touchend\", onUp);\r\n                document.removeEventListener(\"touchcancel\", onUp);\r\n            }\r\n\r\n            if (e.clientX) {\r\n                x = x + e.clientX - pos;\r\n                slider.setValue(Math.round(x / unitWidth));\r\n                slider.fire(\"slide\", { targetSlider: slider });\r\n            } else if (e.touches && e.touches[0]) {\r\n                x = x + e.touches[0].clientX - pos;\r\n                slider.setValue(Math.round(x / unitWidth));\r\n                slider.fire(\"slide\", { targetSlider: slider });\r\n            }\r\n        };\r\n\r\n        if (type === \"pointer\") {\r\n            if (navigator.pointerEnabled) {\r\n                document.addEventListener(\"pointermove\", onMove);\r\n                document.addEventListener(\"pointerup\", onUp);\r\n            } else if (navigator.msPointerEnabled) {\r\n                document.addEventListener(\"MSPointerMove\", onMove);\r\n                document.addEventListener(\"MSPointerUp\", onUp);\r\n            } else {\r\n                document.addEventListener(\"mousemove\", onMove);\r\n                document.addEventListener(\"mouseup\", onUp);\r\n            }\r\n        } else if (type === \"touch\") {\r\n            document.addEventListener(\"touchmove\", onMove);\r\n            document.addEventListener(\"touchend\", onUp);\r\n            document.addEventListener(\"touchcancel\", onUp);\r\n        }\r\n\r\n        slider.setValue(Math.round(x / unitWidth));\r\n        slider.fire(\"slide\", { targetSlider: slider });\r\n    }\r\n};"]}