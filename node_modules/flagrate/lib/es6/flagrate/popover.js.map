{"version":3,"sources":["flagrate/popover.ts"],"names":[],"mappings":"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","file":"popover.js","sourcesContent":["/*\r\n   Copyright 2016 Webnium\r\n\r\n   Licensed under the Apache License, Version 2.0 (the \"License\");\r\n   you may not use this file except in compliance with the License.\r\n   You may obtain a copy of the License at\r\n\r\n       http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n   Unless required by applicable law or agreed to in writing, software\r\n   distributed under the License is distributed on an \"AS IS\" BASIS,\r\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n   See the License for the specific language governing permissions and\r\n   limitations under the License.\r\n*/\r\n\"use strict\";\r\n\r\nimport { Element, FHTMLElement, FHTMLDivElement } from \"./element\";\r\n\r\n/*?\r\n    class flagrate.Popover\r\n**/\r\nexport interface Option {\r\n    target?: HTMLElement;\r\n    text?: string;\r\n    html?: string;\r\n    element?: HTMLElement;\r\n    className?: string;\r\n}\r\n\r\n/*?\r\n    flagrate.createPopover(option)\r\n    new flagrate.Popover(option)\r\n    - option (Object) - options.\r\n\r\n    Popover.\r\n\r\n    #### option\r\n\r\n    * `target`    (Element):\r\n    * `text`      (String):\r\n    * `html`      (String):\r\n    * `element`   (Element):\r\n    * `className` (String):\r\n**/\r\nexport class Popover {\r\n\r\n    private _target: FHTMLElement;\r\n    private _text: string;\r\n    private _html: string;\r\n    private _element: HTMLElement;\r\n    private _className: string;\r\n\r\n    private _div: FHTMLDivElement;\r\n    private _positioningTimer: number;\r\n    private _isShowing = false;\r\n\r\n    private _openHandler = this.open.bind(this);\r\n    private _closeHandler = this.close.bind(this);\r\n\r\n    constructor(opt: Option = {}) {\r\n\r\n        if (opt.target) {\r\n            if (!opt.target[\"isFlagrated\"]) {\r\n                opt.target = Element.extend(opt.target);\r\n            }\r\n            this._target = opt.target as FHTMLElement;\r\n        }\r\n        if (opt.text) {\r\n            this._text = opt.text;\r\n        }\r\n        if (opt.html) {\r\n            this._html = opt.html;\r\n        }\r\n        if (opt.element) {\r\n            this._element = opt.element;\r\n        }\r\n        if (opt.className) {\r\n            this._className = opt.className;\r\n        }\r\n\r\n        if (this._target) {\r\n            this._target.addEventListener(\"mouseover\", this._openHandler);\r\n        }\r\n    }\r\n\r\n    get target(): FHTMLElement {\r\n        return this._target;\r\n    }\r\n\r\n    set target(element: FHTMLElement) {\r\n        this.setTarget(element);\r\n    }\r\n\r\n    get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    set text(text: string) {\r\n        this.setText(text);\r\n    }\r\n\r\n    get html(): string {\r\n        return this._html;\r\n    }\r\n\r\n    set html(html: string) {\r\n        this.setHTML(html);\r\n    }\r\n\r\n    get element(): HTMLElement {\r\n        return this._element;\r\n    }\r\n\r\n    set element(element: HTMLElement) {\r\n        this.setElement(element);\r\n    }\r\n\r\n    get className(): string {\r\n        return this._className;\r\n    }\r\n\r\n    set className(className: string) {\r\n        this.setClassName(className);\r\n    }\r\n\r\n    get isShowing(): boolean {\r\n        return this._isShowing;\r\n    }\r\n\r\n    set isShowing(boolean: boolean) {\r\n\r\n        if (boolean === true) {\r\n            this.open();\r\n        } else {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    open(forceTarget?: Event | HTMLElement): this {\r\n\r\n        if (this._isShowing === true) {\r\n            this.close();\r\n        }\r\n\r\n        let target = this._target || document.documentElement;\r\n\r\n        if (forceTarget instanceof Event) {\r\n            if (Element.isElement(forceTarget.target) === true) {\r\n                target = forceTarget.target as HTMLElement;\r\n            }\r\n\r\n            document.body.addEventListener(\"click\", this._closeHandler);\r\n            document.body.addEventListener(\"mouseout\", this._closeHandler);\r\n            document.body.addEventListener(\"mouseup\", this._closeHandler);\r\n            window.addEventListener(\"scroll\", this._closeHandler);\r\n        } else if (Element.isElement(forceTarget) === true) {\r\n            target = forceTarget;\r\n        }\r\n\r\n        const div = this._create();\r\n\r\n        this._positioningTimer = setInterval(() => {\r\n\r\n            if (Element.exists(target) === true) {\r\n                _updatePosition(target, div);\r\n            } else {\r\n                this.close();\r\n            }\r\n        }, 10);\r\n\r\n        this._div.on(\"click\", e => e.stopPropagation());\r\n        this._div.on(\"mouseup\", e => e.stopPropagation());\r\n        this._div.on(\"mousewheel\", e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        });\r\n\r\n        _updatePosition(target, div);\r\n\r\n        return this;\r\n    }\r\n\r\n    close(): this {\r\n\r\n        if (this._div === undefined) {\r\n            return this;\r\n        }\r\n\r\n        clearInterval(this._positioningTimer);\r\n\r\n        document.body.removeEventListener(\"click\", this._closeHandler);\r\n        document.body.removeEventListener(\"mouseup\", this._closeHandler);\r\n        document.body.removeEventListener(\"mouseout\", this._closeHandler);\r\n        window.removeEventListener(\"scroll\", this._closeHandler);\r\n\r\n        this._isShowing = false;\r\n\r\n        const div = this._div;\r\n\r\n        div.removeClassName(\"flagrate-popover-visible\");\r\n\r\n        setTimeout(() => {\r\n            if (div && div.remove) {\r\n                div.remove();\r\n            }\r\n        }, 1000);\r\n\r\n        delete this._div;\r\n\r\n        return this;\r\n    }\r\n\r\n    visible(): boolean {\r\n        return this._isShowing && !!this._div.hasClassName(\"flagrate-popover-visible\");\r\n    }\r\n\r\n    remove(): void {\r\n\r\n        if (this._div) {\r\n            this.close();\r\n        }\r\n\r\n        if (this._target) {\r\n            this._target.removeEventListener(\"mouseover\", this._openHandler);\r\n        }\r\n    }\r\n\r\n    setTarget(element: FHTMLElement): this {\r\n\r\n        if (this._target === element) {\r\n            return this;\r\n        }\r\n        if (!element[\"isFlagrated\"]) {\r\n            element = Element.extend(element);\r\n        }\r\n        this._target = element;\r\n\r\n        if (this._isShowing === true) {\r\n            this.open();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setText(text: string): this {\r\n\r\n        if (this._text === text) {\r\n            return this;\r\n        }\r\n        this._text = text;\r\n\r\n        if (this._isShowing === true) {\r\n            this._div.updateText(text);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setHTML(html: string): this {\r\n\r\n        if (this._html === html) {\r\n            return this;\r\n        }\r\n        this._html = html;\r\n\r\n        if (this._isShowing === true) {\r\n            this._div.update(html);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setElement(element: HTMLElement): this {\r\n\r\n        if (this._element === element) {\r\n            return this;\r\n        }\r\n        this._element = element;\r\n\r\n        if (this._isShowing === true) {\r\n            this._div.update(element);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setClassName(className: string): this {\r\n\r\n        if (this._className === className) {\r\n            return this;\r\n        }\r\n\r\n        if (this._isShowing === true) {\r\n            this._div.removeClassName(this._className).addClassName(className);\r\n        }\r\n\r\n        this._className = className;\r\n\r\n        return this;\r\n    }\r\n\r\n    private _create(): FHTMLDivElement {\r\n\r\n        this._isShowing = true;\r\n\r\n        const div = this._div = new Element(\"div\", {\r\n            \"class\": \"flagrate flagrate-popover\"\r\n        });\r\n\r\n        if (this._className) {\r\n            div.addClassName(this._className);\r\n        }\r\n\r\n        if (this._text) {\r\n            div.updateText(this._text);\r\n        }\r\n        if (this._html) {\r\n            div.update(this._html);\r\n        }\r\n        if (this._element) {\r\n            div.update(this._element);\r\n        }\r\n\r\n        div.insertTo(document.body);\r\n\r\n        setTimeout(() => div.addClassName(\"flagrate-popover-visible\"), 0);\r\n\r\n        return div;\r\n    }\r\n}\r\n\r\nexport function createPopover(option?: Option): Popover {\r\n    return new Popover(option);\r\n}\r\n\r\nfunction _updatePosition(target: HTMLElement, div: FHTMLDivElement) {\r\n\r\n    const tOffset = Element.cumulativeOffset(target);\r\n    const tScroll = Element.cumulativeScrollOffset(target);\r\n    const tWidth = Element.getWidth(target);\r\n    const tHeight = Element.getHeight(target);\r\n    const width = div.getWidth();\r\n    const height = div.getHeight();\r\n\r\n    let x = tOffset.left - tScroll.left + Math.round((tWidth / 2) - (width / 2));\r\n    let y = tOffset.top - tScroll.top + tHeight;\r\n\r\n    if (y + height > window.innerHeight) {\r\n        y = window.innerHeight - y + tHeight;\r\n\r\n        div.removeClassName(\"flagrate-popover-tail-top\");\r\n        div.addClassName(\"flagrate-popover-tail-bottom\");\r\n        div.style.top = \"\";\r\n        div.style.bottom = `${y}px`;\r\n    } else {\r\n        div.removeClassName(\"flagrate-popover-tail-bottom\");\r\n        div.addClassName(\"flagrate-popover-tail-top\");\r\n        div.style.top = `${y}px`;\r\n        div.style.bottom = \"\";\r\n    }\r\n\r\n    div.style.left = `${x}px`;\r\n}"]}