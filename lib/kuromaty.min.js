!function e(t,i,n){function s(o,a){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i=t[o][1][e];return s(i||e)},u,u.exports,e,t,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,i){/*!
    Copyright 2017 Kuromatch
*/
"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Order=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("decimal.js-light");i.Order=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.price=new s.Decimal(t.price),this.origSize=new s.Decimal(t.origSize),this.size=new s.Decimal(t.size),this.side=t.side,this.type=t.type}return n(e,[{key:"merge",value:function(e){if(!this.price.equals(e.price))throw new Error("Can not merge different price orders.");if(this.side!==e.side)throw new Error("Double options is not supported.");this.origSize=this.origSize.plus(e.origSize),this.size=this.size.plus(e.size)}}]),e}()},{"decimal.js-light":7}],2:[function(e,t,i){/*!
    Copyright 2017 Kuromatch
*/
"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.OrderSet=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("./Order");i.OrderSet=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.orders={},this._length=0,t&&t.forEach(function(e){i.add(new s.Order(e))})}return n(e,[{key:"add",value:function(e){var t=e.price.toString(),i=this.orders[t];i?i.merge(e):(this.orders[t]=e,this._length++)}},{key:"forEach",value:function(e){var t=this.orders;Object.keys(t).forEach(function(i){return e(t[i],i)})}},{key:"isEmpty",value:function(){return 0===this._length}}]),e}()},{"./Order":1}],3:[function(e,t,i){/*!
    Copyright 2017 Kuromatch
*/
"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Position=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("decimal.js-light");i.Position=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.price=new s.Decimal(t.price),this.size=new s.Decimal(t.size),this.side=t.side,this._sideSign=new s.Decimal("S"===t.side?1:-1)}return n(e,[{key:"marginAgainst",value:function(e){return this.price.minus(e).mul(this.size).mul(this._sideSign).toNumber()}},{key:"merge",value:function(e){if(!this.price.equals(e.price))throw new Error("Can not merge different price positions.");if(this.side!=e.side)throw new Error("Double options is not supported.");this.size=this.size.plus(e.size)}}]),e}()},{"decimal.js-light":7}],4:[function(e,t,i){/*!
    Copyright 2017 Kuromatch
*/
"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PositionSet=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("./Position"),r=e("decimal.js-light");i.PositionSet=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positions={},this._size=new r.Decimal(0),this._length=0,t&&t.forEach(function(e){i.add(new s.Position(e))})}return n(e,[{key:"add",value:function(e){this._size=this._size.plus(e.size);var t=e.price.toString(),i=this.positions[t];i?i.merge(e):(this.positions[t]=e,this._length++)}},{key:"forEach",value:function(e){var t=this.positions;Object.keys(t).forEach(function(i){return e(t[i],i)})}},{key:"marginAgainst",value:function(e){var t=0;return this.forEach(function(i){t+=i.marginAgainst(e)}),t}},{key:"isEmpty",value:function(){return 0===this._length}},{key:"size",get:function(){return this._size.toNumber()}}]),e}()},{"./Position":3,"decimal.js-light":7}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Kuromaty=void 0;var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){s=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./util")),o=e("./PositionSet"),a=e("./OrderSet"),l=function(e){return e&&e.__esModule?e:{default:e}}(e("flagrate/lib/es6/flagrate")),c=e("decimal.js-light"),u=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=i,this.timePeriod=1,this.barIndex=0,this.cursorPrice=0,this.cursorVolume=0,this.cursorBoard=0,this.cursorBoardPrice=0,this.pinnedPrices=[],this.maxBarCount=8200,this.hasDepleted=!1,this.color={bg:"#fafafa",text:"#333333",textStrong:"#111111",textWeak:"#777777",short:"#e9546b",long:"#3eb370",askOrder:"#ff303e",bidOrder:"#17cb00",volume:"#9b7cb6",askDepth:"rgba(210,179,189,0.21)",bidDepth:"rgba(201,210,179,0.25)",askDepthLast:"rgba(210,179,189,0.45)",bidDepthLast:"rgba(201,210,179,0.55)",grid:"#eeeeee",border:"#cccccc",borderText:"#111111",borderLTP:"rgba(255,150,25,0.6)",borderLTPText:"#ffffff",lineMA1:"#e9e7c6",lineMA2:"#c6e6e9",lineMA3:"#e9c6e8"},this.cursorX=-1,this.cursorY=-1,this.canvasW=0,this.canvasH=0,this._dpr=window.devicePixelRatio,this._hasUpdated=!1,this._hasRemoved=!0,this._afs=0,this._pricePops=[],this._lastPointerdown=[0,0],this._lastPointerButtons=0,this._positions=new o.PositionSet,this._orders=new a.OrderSet,this.__keydownHandler=this._keydownHandler.bind(this),"number"!=typeof i.chartCount&&(i.chartCount=1),void 0===i.chartTitles&&(i.chartTitles=[]),void 0===i.chartOverlay&&(i.chartOverlay=!1),i.barWidth=i.barWidth||5,i.barMargin=i.barMargin||3,i.decimalPower=i.decimalPower||0,this._decimal=parseInt("1"+Array(i.decimalPower+1).join("0"),10),this._create(),t&&this.insertTo(t)}return s(e,[{key:"insertTo",value:function(e){e.appendChild(this._rootContainer),this._hasRemoved=!1,this.resize()}},{key:"remove",value:function(){this._removeListeners(),this._rootContainer.parentNode.removeChild(this._rootContainer),this.canvasW=this.canvasH=0,this._hasRemoved=!0,cancelAnimationFrame(this._afr)}},{key:"resize",value:function(){var e=this.canvasW=this._chartContainer.clientWidth,t=this.canvasH=this._chartContainer.clientHeight;e*=this._dpr,t*=this._dpr,this.canvases.forEach(function(i){i.width=e,i.height=t}),this._hasUpdated=!0,this._redraw()}},{key:"zoom",value:function(e){this.options.barWidth=Math.min(11,Math.max(1,this.options.barWidth+e)),this._hasUpdated=!0}},{key:"update",value:function(e,t){this.charts[e].bars=t,this._hasUpdated=!0}},{key:"updateHBars",value:function(e,t){this.charts[e].hBars=t,this._hasUpdated=!0}},{key:"tick",value:function(e,t){var i=this.charts[e];i.tickDelta=0,i.ticks[0]&&i.bars[0]&&i.bars[0][4]!==t[1]&&(i.tickDelta=t[1]-i.bars[0][4]),(!i.ticks[0]||1e3<t[0]-i.ticks[0][0])&&(i.ticks.unshift(t),i.ticks.length>250&&i.ticks.pop());var n=Date.now()-6e4;i.bars.length>0&&(n=i.bars[0][0]);var s=i.bars[0],r=t[0];if(s&&new Date(n).getMinutes()===new Date(r).getMinutes())s[2]<t[1]&&(s[2]=t[1]),s[3]>t[1]&&(s[3]=t[1]),s[4]=t[1],s[5]<t[2]&&(s[5]=t[2]),s[6]=t[3],s[7]=t[4],s[8]<t[5]&&(s[8]=t[5]),s[9]<t[6]&&(s[9]=t[6]);else for(var o=Math.floor((r-n)/1e3/60);o>0;o--)1===o?i.bars.unshift([new Date(t[0]).setSeconds(0,0),t[1],t[1],t[1],t[1],t[2],t[3],t[4],t[5],t[6]]):i.bars.unshift([new Date(t[0]).setSeconds(0,0)-6e4*(o-1),i.ticks[0][1],i.ticks[0][1],i.ticks[0][1],i.ticks[0][1],i.ticks[0][2],i.ticks[0][3],i.ticks[0][4],i.ticks[0][5],i.ticks[0][6]]),i.bars.length>this.maxBarCount&&i.bars.pop();this._hasUpdated=!0}},{key:"updateBoard",value:function(e,t){function i(e){if(0===e.length)return[];for(var t={price:s(e[0].price),size:0},i=new c.Decimal(0),n=[t],r=0;r<e.length;r++){var u=s(e[r].price);if(u<l||a<u)break;t.price!==u?(o<t.size&&(o=t.size),t={price:u,size:e[r].size},i=new c.Decimal(t.size),n.push(t)):(i=i.plus(e[r].size),t.size=i.toNumber())}return o<t.size&&(o=t.size),n}t=r.deepCopy(t);var n=this.charts[e],s=r.generatePriceGrouping(this._decimal,this.options.boardGroupSize),o=0,a=n.highest,l=n.lowest;t.asks=i(t.asks),t.bids=i(t.bids),n.board=t,n.boardMaxSize=o,this._hasUpdated=!0}},{key:"setColor",value:function(e){for(var t in e)this.color[t]=e[t];this._chartContainer.style.borderColor=this.color.border}},{key:"setPositions",value:function(e){this._positions=new o.PositionSet(e)}},{key:"setOrders",value:function(e){this._orders=new a.OrderSet(e)}},{key:"_create",value:function(){var e=this;this._rootContainer=document.createElement("div"),this._rootContainer.className="kuromaty",this._chartContainer=document.createElement("div"),this._chartContainer.className="kuromaty-chart",this._chartContainer.style.borderColor=this.color.border,this._rootContainer.appendChild(this._chartContainer),this.charts=[],this.canvases=[],this.contexts=[],this.overlay={canvas:document.createElement("canvas"),context:null},this.overlay.context=this.overlay.canvas.getContext("2d"),this.canvases.push(this.overlay.canvas),this.contexts.push(this.overlay.context),this.overlay.canvas.addEventListener("pointerdown",this._pointerdownHandler.bind(this)),this.overlay.canvas.addEventListener("pointerup",this._pointerupHandler.bind(this)),this.overlay.canvas.addEventListener("pointermove",this._pointermoveHandler.bind(this)),this.overlay.canvas.addEventListener("pointerout",this._pointeroutHandler.bind(this)),this.overlay.canvas.addEventListener("wheel",this._wheelHandler.bind(this)),this.overlay.canvas.addEventListener("contextmenu",this._contextmenuHandler.bind(this));for(var t=0;t<this.options.chartCount;t++){var i={title:this.options.chartTitles[t]||"Untitled",canvas:document.createElement("canvas"),context:null,bars:[],hBars:[],_bars:[],ticks:[],board:null,boardMaxSize:0,range:0,highest:0,highestPrice:0,highestPricePrinted:!1,lowest:0,lowestPrice:0,lowestPricePrinted:!1,askPrice:0,bidPrice:0,maxVolume:0,volumeRatio:0,maxDepth:0,minDepth:0,depthRatio:1,latest:0,ratio:1,tickDelta:0,selected:0===t};i.context=i.canvas.getContext("2d"),this.charts.push(i),this.canvases.push(i.canvas),this.contexts.push(i.context)}this.grid={canvas:document.createElement("canvas"),context:null},this.grid.context=this.grid.canvas.getContext("2d"),this.canvases.push(this.grid.canvas),this.contexts.push(this.grid.context),this.canvases.reverse(),this.contexts.reverse(),this.canvases.forEach(function(t){e._chartContainer.appendChild(t)}),this._addListeners()}},{key:"_addListeners",value:function(){window.addEventListener("keydown",this.__keydownHandler)}},{key:"_removeListeners",value:function(){window.removeEventListener("keydown",this.__keydownHandler)}},{key:"_redraw",value:function(){var e=this;this._afr&&cancelAnimationFrame(this._afr),this.contexts.forEach(function(t){t.scale(e._dpr,e._dpr),t.imageSmoothingEnabled=!1});this._afr=requestAnimationFrame(function t(){e._hasUpdated&&e.canvasW>40&&e.canvasH>40&&(e._hasUpdated=!1,e._draw()),e._hasRemoved||(e._afr=requestAnimationFrame(t))})}},{key:"_draw",value:function(){var e=this,t=this.canvasW,i=this.canvasH,n=this.options.barWidth+this.options.barMargin,s=t-45,o=i-16,a=n*Math.max(2,5-this.barIndex),l=Math.max(0,this.barIndex-3),u=Math.round((s-a)/n)-1,h=this._decimal,d=this.options.decimalPower,f=this.timePeriod,g=0,p=0,m=0,v=this.charts.length,_=0,b=1/0,y=0,x=0,w=1/0,k=void 0,S=0,C=void 0,T=void 0,E=void 0,N=void 0;for(this.hasDepleted=!1,p=0;p<v;p++){var P=this.charts[p];if(P.context.clearRect(0,0,t,i),0!==f||P.selected){for(_=0,b=1/0,y=0,x=0,w=1/0,P._bars=this._getBars(p,l,2*u),m=Math.min(u,P._bars.length),P.selected&&u>P._bars.length&&this.maxBarCount>P.bars.length&&(this.hasDepleted=!0),g=0;g<m&&(k=P._bars[g]);g++)_<k[2]&&(_=k[2]),b>k[3]&&(b=k[3]),y<k[5]&&(y=k[5]),x<k[6]&&(x=k[6]),w>k[6]&&(w=k[6]),x<k[7]&&(x=k[7]),w>k[7]&&(w=k[7]);if(0===P._bars.length)return;P.latest=P.bars[0][4],P.highestPrice=_,P.lowestPrice=b,P.highestPricePrinted=!1,P.lowestPricePrinted=!1;var M=o/(_-b);P.highest=_+Math.round(o/3/M*h)/h,P.lowest=b-Math.round(o/3/M*h)/h,P.range=P.highest-P.lowest,P.ratio=o/P.range,P.maxVolume=y,P.volumeRatio=o/5/y,P.maxDepth=x,P.minDepth=w,P.depthRatio=o/5/(x-w),P.canvas.style.opacity=P.selected?"1":"0.2",P.context.fillStyle=this.color.border,P.context.fillRect(s,0,1,o),P.context.fillRect(0,o,s+1,1)}}this.grid.context.clearRect(0,0,t,i),this.grid.context.fillStyle=this.color.bg,this.grid.context.fillRect(0,0,t,i),this.grid.context.textAlign="center",this.overlay.context.clearRect(0,0,t,i);var O=function(){var t=e.charts[p],u=t.context,v=s-a;if(0===f&&!t.selected)return"continue";for(g=0;g<m&&((k=t._bars[g])&&t._bars[g+1]);g++)if(0!==g&&(v-=n),t.selected&&(u.fillStyle=0===g&&l<1?e.color.askDepthLast:e.color.askDepth,u.fillRect(v-e.options.barWidth,0,n,Math.round((k[6]-t.minDepth)*t.depthRatio)),u.fillStyle=0===g&&l<1?e.color.bidDepthLast:e.color.bidDepth,u.fillRect(v-e.options.barWidth,o,n,-Math.round((k[7]-t.minDepth)*t.depthRatio))),u.fillStyle=e.color.volume,u.fillRect(v-Math.ceil(e.options.barWidth/2),o,1,-Math.round(k[5]*t.volumeRatio)),0!==f&&(S=Math.round((k[1]-k[4])*t.ratio),u.fillStyle=k[1]>k[4]?e.color.short:e.color.long,u.fillRect(v-e.options.barWidth,Math.round((t.highest-k[1])*t.ratio),e.options.barWidth,0===S?1:S),u.fillRect(v-Math.ceil(e.options.barWidth/2),Math.round((t.highest-k[2])*t.ratio),1,Math.round((k[2]-k[3])*t.ratio))),t.selected){if(0!==f&&k[2]===t.highestPrice){e.overlay.context.fillStyle=e.color.long;var _=v-e.options.barWidth/2,b=Math.round((t.highest-k[2])*t.ratio);e.overlay.context.beginPath(),e.overlay.context.moveTo(_,b-2),e.overlay.context.lineTo(_+3,b-5),e.overlay.context.lineTo(_-3,b-5),e.overlay.context.fill(),!1===t.highestPricePrinted&&(t.highestPricePrinted=!0,e.overlay.context.textAlign=g<m/2?"right":"left",e.overlay.context.fillText(new c.Decimal(k[2]).toFixed(d),v-(g<m/2?0:5),b-8),e._drawBorder(e.overlay.context,0,b-.5,s,e.color.long,[1,2]))}if(0!==f&&k[3]===t.lowestPrice){e.overlay.context.fillStyle=e.color.short;var y=v-e.options.barWidth/2,x=Math.round((t.highest-k[3])*t.ratio);e.overlay.context.beginPath(),e.overlay.context.moveTo(y,x+2),e.overlay.context.lineTo(y+3,x+5),e.overlay.context.lineTo(y-3,x+5),e.overlay.context.fill(),!1===t.lowestPricePrinted&&(t.lowestPricePrinted=!0,e.overlay.context.textAlign=g<m/2?"right":"left",e.overlay.context.fillText(new c.Decimal(k[3]).toFixed(d),v-(g<m/2?0:5),x+15),e._drawBorder(e.overlay.context,0,x+.5,s,e.color.short,[1,2]))}if(C=new Date(k[0]),T=C.getMinutes(),E=C.getHours(),N=C.getDate(),0===f&&g%10==0||f>=1&&f<3&&T%15==0||f>=3&&f<5&&T%30==0||f>=5&&f<10&&T%60==0||f>=10&&f<15&&T%60==0&&E%2==0||f>=15&&f<30&&T%60==0&&E%3==0||f>=30&&f<60&&T%60==0&&E%6==0||f>=60&&f<120&&T%60==0&&E%12==0||f>=120&&f<240&&0===E||f>=240&&f<360&&0===E&&N%2==0||f>=360&&f<720&&0===E&&N%3==0||f>=720&&0===E&&N%7==0){e.grid.context.fillStyle=e.color.grid,e.grid.context.fillRect(v-Math.ceil(e.options.barWidth/2),0,1,o);var w=void 0;w=0===E&&0===T?C.getMonth()+1+"/"+N+"'":E+":"+r.zeroPadding(T,2),e.grid.context.fillStyle=e.color.text,e.grid.context.font="10px sans-serif",e.grid.context.fillText(w,v-Math.ceil(e.options.barWidth/2),i-4)}}if(t.selected){var P=Math.round((t.highest-t.latest)*t.ratio);P||(P=Math.round(i/2));var M=1/0,O=0,A=1===h?1e3:100/h;for(0===f&&(A/=100),g=t.lowest-t.lowest%A;g<t.highest;g+=A)M-(O=Math.round((t.highest-g)*t.ratio))<80||O+30>o||(e.grid.context.fillStyle=e.color.grid,e.grid.context.fillRect(0,O,s,1),e.grid.context.fillStyle=e.color.textWeak,e.grid.context.font="11px sans-serif",e.grid.context.textAlign="left",e.grid.context.fillText(new c.Decimal(g).toFixed(d),s+2,O+5,39),M=O);e._drawVerticalRange(e.grid.context,s-a+n,(t.highest-t.highestPrice)*t.ratio,(t.highestPrice-t.lowestPrice)*t.ratio,e.color.border,[2,1]);var H=t.highestPrice-t._bars[0][2]>t._bars[0][3]-t.lowestPrice?(t.highest-t.highestPrice)*t.ratio+40:(t.highest-t.lowestPrice)*t.ratio-40;if(e.grid.context.save(),e.grid.context.fillStyle=e.color.bg,e.grid.context.fillRect(s-a+n,H-10,1,12),e.grid.context.textAlign="right",e.grid.context.fillStyle=e.color.textWeak,e.grid.context.font="10px sans-serif",e.grid.context.globalAlpha=.6,e.grid.context.fillText(new c.Decimal(t.highestPrice-t.lowestPrice).toFixed(d),s-a+n+6,H),e.grid.context.restore(),e.overlay.context.save(),t._bars[0][8]>t._bars[0][9]){var L=e.overlay.context.createLinearGradient(0,1,0,P-2);L.addColorStop(0,e.color.askOrder),L.addColorStop(1,e.color.bg),e.overlay.context.fillStyle=L,e.overlay.context.globalAlpha=(t._bars[0][8]-t._bars[0][9])/t._bars[0][5],e.overlay.context.fillRect(s-1,1,-4,P-2)}else if(t._bars[0][8]<t._bars[0][9]){var D=e.overlay.context.createLinearGradient(0,P+1,0,o);D.addColorStop(0,e.color.bg),D.addColorStop(1,e.color.bidOrder),e.overlay.context.fillStyle=D,e.overlay.context.globalAlpha=(t._bars[0][9]-t._bars[0][8])/t._bars[0][5],e.overlay.context.fillRect(s-1,o-1,-4,-(o-P-2))}if(e.overlay.context.restore(),e.cursorX>-1&&(e._drawDepthIndicator(e.overlay.context,s-a-7,40,"Sell Vol. "+new c.Decimal(t._bars[0][8]).toFixed(1),e.color.askOrder),e._drawDepthIndicator(e.overlay.context,s-a-7,o-40,"Buy Vol. "+new c.Decimal(t._bars[0][9]).toFixed(1),e.color.bidOrder)),t._bars[0][6]&&t._bars[0][7]&&(e._drawDepthIndicator(e.overlay.context,s-a-7,20,"Ask Depth "+Math.round(t._bars[0][6]),e.color.askDepthLast),e._drawDepthIndicator(e.overlay.context,s-a-7,o-20,"Bid Depth "+Math.round(t._bars[0][7]),e.color.bidDepthLast)),t.askPrice&&t.bidPrice){var B=Math.round((t.highest-t.askPrice)*t.ratio),I=Math.round((t.highest-t.bidPrice)*t.ratio);e._drawPriceTag2(e.overlay.context,s-a+Math.round(n/2),B,a-Math.round(n/2),t.askPrice,e.color.long,[2,2]),e._drawPriceTag2(e.overlay.context,s-a+Math.round(n/2),I,a-Math.round(n/2),t.bidPrice,e.color.short,[2,2])}if(t.board){var R=void 0,j=Math.round(e.options.boardGroupSize/h*t.ratio);for(e.overlay.context.save(),e.overlay.context.fillStyle=e.color.askOrder,g=0;g<t.board.asks.length-1;g++)R=t.board.asks[g],e.overlay.context.globalAlpha=Math.min(1,R.size/t.boardMaxSize+.12),e.overlay.context.fillRect(s-1,Math.round((t.highest-R.price)*t.ratio),-(Math.min(19,Math.ceil(R.size/t.boardMaxSize*19))+1),-j);for(e.overlay.context.fillStyle=e.color.bidOrder,g=0;g<t.board.bids.length-1;g++)R=t.board.bids[g],e.overlay.context.globalAlpha=Math.min(1,R.size/t.boardMaxSize+.12),e.overlay.context.fillRect(s-1,Math.round((t.highest-R.price)*t.ratio),-(Math.min(19,Math.ceil(R.size/t.boardMaxSize*19))+1),j);e.overlay.context.restore()}e.pinnedPrices.forEach(function(i){e._drawPriceTag(e.overlay.context,0,Math.round((t.highest-i)*t.ratio),s,i,i>t.latest?e.color.long:e.color.short,"#ffffff",[3,3])}),e._positions.forEach(function(i){e._drawPositionMarker(e.overlay.context,0,Math.round((t.highest-i.price)*t.ratio),s,i,t.latest)}),e._orders.forEach(function(i){e._drawOrderMarker(e.overlay.context,0,Math.round((t.highest-i.price)*t.ratio),s,i,t.latest)});var z=e.color.borderLTP;t.highestPrice===t.latest?z=e.color.long:t.lowestPrice===t.latest&&(z=e.color.short),e._drawPriceTag(e.overlay.context,0,P,s,t.latest,z,e.color.borderLTPText,[]),e.options.pricePopEffect&&e._drawPricePopEffect(t,h,s,P)}};for(p=0;p<v;p++){O()}for(p=0;p<v;p++){var A=this.charts[p];if(!A.selected)break;var H=A.context,L=s-a-.5;0===f?this._drawSMA(H,L,A,m,1,this.color.text):(this._drawSMA(H,L,A,m,10,this.color.lineMA1),this._drawSMA(H,L,A,m,21,this.color.lineMA2),this._drawSMA(H,L,A,m,34,this.color.lineMA3))}if(C=new Date(this.charts[0]._bars[0][0]),this.grid.context.textAlign="right",this.grid.context.fillStyle=this.color.text,this.grid.context.fillText(":"+r.zeroPadding(C.getMinutes(),2),t-45,i-4),this.cursorPrice=0,this.cursorX>0&&this.cursorY>30&&this.cursorX<s&&this.cursorY<o){var D=this.cursorX-this.cursorX%n;g=Math.round((s-D-a-this.options.barWidth)/n),D=Math.floor(s-a-g*n-n/2)-1,this.grid.context.fillStyle=this.color.grid,this.grid.context.fillRect(D,0,this.options.barWidth,o);var B=this.charts[0];this.cursorPrice=Math.ceil((B.highest-this.cursorY/B.ratio)*h)/h,this.cursorPrice=1===h?50*Math.round(this.cursorPrice/50):Math.round(this.cursorPrice*(h/10))/(h/10);var I=Math.round((B.highest-this.cursorPrice)*B.ratio);if(this._drawPriceTag(this.overlay.context,0,I,s,this.cursorPrice,this.color.border,this.color.textStrong,[]),this.cursorBoard=0,this.cursorBoardPrice=0,B.board){if(this.cursorPrice>B.latest)for(p=B.board.asks.length-1;p>=0;p--)if(B.board.asks[p].price<=this.cursorPrice){this.cursorBoard=B.board.asks[p].size,this.cursorBoardPrice=B.board.asks[p].price;break}if(this.cursorPrice<B.latest)for(p=B.board.bids.length-1;p>=0;p--)if(B.board.bids[p].price>=this.cursorPrice){this.cursorBoard=B.board.bids[p].size,this.cursorBoardPrice=B.board.bids[p].price;break}}if(this.cursorBoard=Math.round(this.cursorBoard),this.cursorBoard>0){var R=Math.round((B.highest-this.cursorBoardPrice)*B.ratio);this._drawBorder(this.overlay.context,s-25,R+(this.cursorPrice>B.latest?-.5:.5),10,this.cursorPrice>B.latest?this.color.askOrder:this.color.bidOrder,[1,1]),this.overlay.context.save(),this.overlay.context.globalAlpha=.8,this.overlay.context.fillStyle=this.color.bg,this.overlay.context.fillRect(s-29,R-7,-22,13),this.overlay.context.globalAlpha=1,this.overlay.context.textAlign="right",this.overlay.context.fillStyle=this.cursorPrice>B.latest?this.color.askOrder:this.color.bidOrder,this.overlay.context.fillText(this.cursorBoard.toString(10),s-29,R+3,20),this.overlay.context.restore()}if(this.overlay.context.save(),g>=0&&g<B._bars.length){this.grid.context.fillStyle=this.color.grid,this.grid.context.fillRect(D-13,o,31,20);var j=0===(C=new Date(B._bars[g][0])).getHours()&&0===C.getMinutes()?C.getMonth()+1+"/"+C.getDate()+"'":C.getHours()+":"+r.zeroPadding(C.getMinutes(),2);this.grid.context.textAlign="center",this.grid.context.fillStyle=this.color.textStrong,this.grid.context.font="10px sans-serif",this.grid.context.fillText(j,D+this.options.barWidth/2,i-4),this.overlay.context.textAlign="left",this.overlay.context.fillStyle=this.color.textStrong,this.overlay.context.font="12px monospace";var z=Math.round(1e3*(100-B._bars[g][1]/B._bars[g][4]*100))/1e3;this.overlay.context.fillText(C.toLocaleString()+"  O "+new c.Decimal(B._bars[g][1]).toFixed(d)+"  H "+new c.Decimal(B._bars[g][2]).toFixed(d)+"  L "+new c.Decimal(B._bars[g][3]).toFixed(d)+"  C "+new c.Decimal(B._bars[g][4]).toFixed(d)+"  "+r.toStringWithSign(z)+"%",10,20),this.overlay.context.fillText("[価格マーカー] 左クリックで追加・削除",10,40),B._bars[g+1]&&(this.overlay.context.globalAlpha=.8,this.overlay.context.fillStyle=this.color.bg,this.overlay.context.fillRect(D+n/2-17,(B.highest-B.lowestPrice)*B.ratio+2,34,13),this.overlay.context.globalAlpha=1,this.overlay.context.textAlign="center",this.overlay.context.font="10px sans-serif",this.overlay.context.fillStyle=this.color.volume,this.overlay.context.fillText(Math.round(B._bars[g][5]).toString(10),D+n/2,(B.highest-B.lowestPrice)*B.ratio+12,30))}if(this.overlay.context.restore(),!this._positions.isEmpty()&&this.cursorPrice){var V=Math.floor(this._positions.marginAgainst(this.cursorPrice)),F=r.toStringWithSign(V);this.overlay.context.save(),this.overlay.context.globalAlpha=.8,this.overlay.context.fillStyle=this.color.bg,this.overlay.context.fillRect(6,I-5,60,13),this.overlay.context.globalAlpha=1,this.overlay.context.textAlign="left",this.overlay.context.fillStyle=V<0?this.color.short:this.color.long,this.overlay.context.fillText(F,10,I+5,56),this.overlay.context.restore()}}else this.overlay.context.save(),this.overlay.context.textAlign="left",this.overlay.context.font="11px monospace",this.overlay.context.fillStyle=this.color.text,this.overlay.context.fillText("> "+this.charts[0].title,10,20),this.charts[1]&&(this.overlay.context.fillStyle=this.color.textWeak,this.overlay.context.fillText("  "+this.charts[1].title,10,35)),this.overlay.context.restore();if(!this._positions.isEmpty()){var W=this.charts[0],U=Math.floor(this._positions.marginAgainst(W.latest)),q="建玉: "+this._positions.size+"  評価損益: "+r.toStringWithSign(U);this.overlay.context.save(),this.overlay.context.font="bold 11px sans-serif",this.overlay.context.textAlign="left",this.overlay.context.strokeStyle=this.color.bg,this.overlay.context.fillStyle=U<0?this.color.short:this.color.long,this.overlay.context.strokeText(q,10,80),this.overlay.context.fillText(q,10,80),this.overlay.context.restore()}0!==this._afs&&(this._afs--,this._hasUpdated=!0)}},{key:"_drawPricePopEffect",value:function(e,t,i,s){var r=void 0;for(r=0;r<this._pricePops.length;r++)this._pricePops[r][0]*=.95,this._pricePops[r][0]<.08?(this._pricePops.splice(r,1),r--):this._pricePops[r][5]?this._pricePops[r][4]-=.15:this._pricePops[r][4]+=.15;for(0!==e.tickDelta&&(this._pricePops.push([1,(Math.round(Math.abs(e.tickDelta)*t)/t).toString(10),e.tickDelta>0?this.color.long:this.color.short,i-12,e.tickDelta>0?s-8:s+16,e.tickDelta>0,Math.abs(e.tickDelta)/e.latest*100>.025?"bold 11px sans-serif":"10px sans-serif"]),this._afs=Math.max(50,this._afs),e.tickDelta=0),this.overlay.context.save(),this.overlay.context.textAlign="right",r=0;r<this._pricePops.length;r++){var o=n(this._pricePops[r],7),a=o[0],l=o[1],c=o[2],u=o[3],h=o[4],d=(o[5],o[6]);this.overlay.context.font=d,this.overlay.context.globalAlpha=a,this.overlay.context.fillStyle=c,this.overlay.context.fillText(l,u,h)}this.overlay.context.restore()}},{key:"_getBars",value:function(e,t,i){var n=this.charts[e],s=this.timePeriod;if(0===n.bars.length)return[];if(1===s)return n.bars.slice(t,t+i);if(0===s)return n.ticks.slice(t,t+i).map(function(e){return[e[0],e[1],e[1],e[1],e[1],e[2],e[3],e[4],e[5],e[6]]});var o=[],a=void 0,l=0;if(60===s)o.push.apply(o,r.deepCopy(n.hBars.slice(t,t+i)));else if(s>60){var c=n.hBars;0!==t&&(l=t*(s/60)+(a=new Date(c[0][0])).getHours()%(s/60)-s/60);for(var u=Math.min(i*(s/60)+l-1,c.length-1);u>=l;u--)a=new Date(c[u][0]),0===o.length||a.getHours()%Math.ceil(s/60)==0&&o[0][0]<c[u][0]?o.unshift([a.getTime(),c[u][1],c[u][2],c[u][3],c[u][4],c[u][5],c[u][6]||0,c[u][7]||0,c[u][8]||0,c[u][9]||0]):(o[0][2]<c[u][2]&&(o[0][2]=c[u][2]),o[0][3]>c[u][3]&&(o[0][3]=c[u][3]),o[0][4]=c[u][4],o[0][5]+=c[u][5],o[0][6]=c[u][6]||0,o[0][7]=c[u][7]||0,o[0][8]+=c[u][8]||0,o[0][9]+=c[u][9]||0)}var h=n.bars;0!==t&&(l=t*s+(a=new Date(h[0][0])).getMinutes()%s-s);for(var d=Math.min(i*s+l-1,h.length-1)-o.length*(s/60);d>=l;d--)0!==o.length&&o[0][0]>h[d][0]||(a=new Date(h[d][0]),0===o.length||a.getMinutes()%s==0&&a.getHours()%Math.ceil(s/60)==0&&o[0][0]<h[d][0]?o.unshift([a.setSeconds(0,0),h[d][1],h[d][2],h[d][3],h[d][4],h[d][5],h[d][6]||0,h[d][7]||0,h[d][8]||0,h[d][9]||0]):(o[0][2]<h[d][2]&&(o[0][2]=h[d][2]),o[0][3]>h[d][3]&&(o[0][3]=h[d][3]),o[0][4]=h[d][4],o[0][5]+=h[d][5],o[0][6]=h[d][6]||0,o[0][7]=h[d][7]||0,o[0][8]+=h[d][8]||0,o[0][9]+=h[d][9]||0));return o.slice(0,i)}},{key:"_keydownHandler",value:function(e){var t=document.activeElement&&document.activeElement.tagName;if(("BODY"===t||"DIV"===t||"BUTTON"===t)&&""===window.getSelection().toString()){var i=!1;switch(e.keyCode){case 32:i=!0,this.barIndex=0,this._hasUpdated=!0}i&&(e.stopPropagation(),e.preventDefault())}}},{key:"_contextmenuHandler",value:function(e){var t=this;e.stopPropagation(),e.preventDefault();var i=this.cursorPrice,n=this.charts[0].latest>i?"buy":"sell",s="buy"===n?"sell":"buy",o="buy"===n?"買い":"売り",a="buy"===s?"買い":"売り",c=[];this.options.quickOrder&&c.push({labelHTML:'<span class="kuromaty-label '+n+'">'+o+"</span> 指値注文...",onSelect:function(){t.options.quickOrderHandler({price:i,type:"limit"})}},{labelHTML:'<span class="kuromaty-label '+s+'">'+a+"</span> STOP-LIMIT 注文...",onSelect:function(){t.options.quickOrderHandler({price:i,type:"stop-limit"})}}),this._contextMenu&&!0===this._contextMenu.visible()&&this._contextMenu.close(),this._contextMenu=new l.default.ContextMenu({target:this._rootContainer,items:[{label:""+i,isDisabled:!0},"--",{labelHTML:"価格をコピー",onSelect:function(){r.copyTextToClipboard(i.toString(10))}}].concat(c,["--",{label:"価格マーカー全消去",onSelect:function(){t.pinnedPrices=[],t._hasUpdated=!0}},"--",{label:"キャンセル"}])}).open(e)}},{key:"_pointerdownHandler",value:function(e){if(e.target===this.overlay.canvas){if(e.preventDefault(),this._contextMenu&&!0===this._contextMenu.visible())return this._contextMenu.close(),void(this._contextMenu=null);var t=e.offsetX,i=e.offsetY;if(!t&&!i&&e.target){var n=e.target.getBoundingClientRect();t=e.clientX-n.left,i=e.clientY-n.top}var s=e.buttons;if(void 0===s&&e.which)switch(e.which){case 2:s=4;break;case 3:s=2;break;default:s=e.which}2!==s&&(this._lastPointerdown=[t,i],this._lastPointerButtons=s,this._dragStartX=void 0)}}},{key:"_pointerupHandler",value:function(e){if(e.target===this.overlay.canvas){var t=e.offsetX,i=e.offsetY;if(!t&&!i){var n=e.target.getBoundingClientRect();t=e.clientX-n.left,i=e.clientY-n.top}if("touch"!==e.pointerType&&this._lastPointerdown[0]===t&&this._lastPointerdown[1]===i&&1===this._lastPointerButtons&&this.cursorPrice){var s=this.pinnedPrices.indexOf(this.cursorPrice);-1===s?this.pinnedPrices.push(this.cursorPrice):this.pinnedPrices.splice(s,1)}this._lastPointerdown=[0,0],this._lastPointerButtons=0,this._hasUpdated=!0,e.preventDefault()}}},{key:"_pointermoveHandler",value:function(e){if(e.target===this.overlay.canvas){var t=e.offsetX,i=e.offsetY;if(!t&&!i){var n=e.target.getBoundingClientRect();t=e.clientX-n.left,i=e.clientY-n.top}var s=e.buttons;if(void 0===s&&e.which)switch(e.which){case 2:s=4;break;case 3:s=2;break;default:s=e.which}if(1===s){e.preventDefault(),this._dragStartX||(this._dragStartX=t,this._dragStartI=this.barIndex);var r=this._dragStartX-t;this.barIndex=this._dragStartI-Math.round(r/(this.options.barWidth+this.options.barMargin)),this.barIndex<0?this.barIndex=0:this.barIndex>=this.charts[0].bars.length&&(this.barIndex=this.charts[0].bars.length-1)}else this._dragStartX=void 0;this.cursorX=t,this.cursorY=i,this._hasUpdated=!0}}},{key:"_pointeroutHandler",value:function(e){this.cursorX=this.cursorY=-1}},{key:"_wheelHandler",value:function(e){e.preventDefault(),e.ctrlKey?this.zoom(e.deltaY<0?1:e.deltaY>0?-1:0):(this.barIndex-=Math.round(e.deltaX?e.deltaX:-e.deltaY/6),this.barIndex<0&&(this.barIndex=0),this._hasUpdated=!0)}},{key:"_drawBorder",value:function(e,t,i,n,s,r){e.save(),e.globalCompositeOperation="destination-over",e.beginPath(),e.lineWidth=1,e.strokeStyle=s,e.setLineDash(r),e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.restore()}},{key:"_drawVerticalRange",value:function(e,t,i,n,s,r){t+=.5,i=Math.round(i),n=Math.round(n),e.save(),e.strokeStyle=s,e.fillStyle=s,e.beginPath(),e.lineWidth=1,e.setLineDash(r),e.moveTo(t,i+1),e.lineTo(t,i+n-2),e.stroke(),e.beginPath(),e.moveTo(t,i),e.lineTo(t+3,i+4),e.lineTo(t-3,i+4),e.moveTo(t,i+n),e.lineTo(t+3,i+n-4),e.lineTo(t-3,i+n-4),e.fill(),e.restore()}},{key:"_drawPriceTag",value:function(e,t,i,n,s,r,o,a,l,u){this._drawBorder(e,t,i+.5,n-5,r,a),n+=t,e.save(),e.globalAlpha=u||1,e.fillStyle=l||r,e.beginPath(),e.moveTo(n-5,i),e.lineTo(n+1,i-6),e.lineTo(n+42,i-6),e.lineTo(n+43,i-5),e.lineTo(n+43,i+6),e.lineTo(n+42,i+7),e.lineTo(n+1,i+7),e.lineTo(n-5,i+1),e.fill(),e.textAlign="left",e.fillStyle=o,e.font="11px sans-serif",e.fillText(new c.Decimal(s).toFixed(this.options.decimalPower),n+2,i+5,39),e.restore()}},{key:"_drawPriceTag2",value:function(e,t,i,n,s,r,o){this._drawBorder(e,t,i+.5,n-5,r,o),n+=t,e.save(),e.fillStyle=this.color.bg,e.fillRect(n+1,i-5,40,10),e.textAlign="left",e.fillStyle=r,e.font="11px sans-serif",e.fillText(new c.Decimal(s).toFixed(this.options.decimalPower),n+2,i+5,39),e.restore()}},{key:"_drawDepthIndicator",value:function(e,t,i,n,s){this._drawBorder(e,t,i+.5,-10,s,[2,2]),e.save(),e.textAlign="right",e.fillStyle=this.color.textWeak,e.strokeStyle=this.color.bg,e.lineWidth=2.5,e.font="10px sans-serif",e.strokeText(n,t-13,i+3.5),e.fillText(n,t-13,i+3.5),e.restore()}},{key:"_drawPositionMarker",value:function(e,t,i,n,s,o){var a="L"===s.side?this.color.long:this.color.short,l=Math.floor(s.marginAgainst(o));this._drawPriceTag(e,t,i,n,s.price.toNumber(),a,"#ffffff",[1,2]),e.save(),e.globalAlpha=.8,e.fillStyle=this.color.bg,e.fillRect(t+4,i-2,80,-13),e.globalAlpha=1,e.textAlign="left",e.fillStyle=a,e.fillText(s.size+" "+s.side+", "+r.toStringWithSign(l),t+6,i-5,76),e.restore()}},{key:"_drawOrderMarker",value:function(e,t,i,n,s,r){var o=this.color.text;switch(s.side){case"L":o=this.color.long;break;case"S":o=this.color.short}this._drawPriceTag(e,t,i,n,s.price.toNumber(),o,"#ffffff",[1,5],null,.45),e.save(),e.globalAlpha=.8,e.fillStyle=this.color.bg,e.fillRect(t+4,i-2,80,-13),e.globalAlpha=1,e.textAlign="left",e.fillStyle=o,e.fillText(s.size+" "+s.side+" "+s.type,t+6,i-5,76),e.restore()}},{key:"_drawSMA",value:function(e,t,i,n,s,r){var o=this.options.barMargin+this.options.barWidth;t+=o,e.save(),e.strokeStyle=r,e.lineWidth=1,e.lineCap="round",e.lineJoin="round",e.setLineDash([]),e.beginPath();for(var a=0,l=void 0,c=0,u=0;a<n&&(i._bars[a]&&i._bars[a+s]);a++){for(t-=o,c=0,l=0;l<s;l++)c+=i._bars[a+l][4];c/=s,u=Math.round((i.highest-c)*i.ratio)+.5,0===a&&e.moveTo(t,u),e.lineTo(t,u)}e.stroke(),e.restore()}}]),e}();i.Kuromaty=u,void 0===window.Kuromaty&&(window.Kuromaty=u),i.default=u},{"./OrderSet":2,"./PositionSet":4,"./util":6,"decimal.js-light":7,"flagrate/lib/es6/flagrate":8}],6:[function(e,t,i){"use strict";function n(e){var t=void 0;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach(function(e,i){("object"===(void 0===e?"undefined":s(e))&&e!=={}||Array.isArray(e)&&e.length>0)&&(t[i]=n(e))}):"object"===(void 0===e?"undefined":s(e))?(t=Object.assign({},e),Object.keys(t).forEach(function(e){("object"===s(t[e])&&t[e]!=={}||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=n(t[e]))})):t=e,t}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
                                                                                                                                                                                                                                                                                  Copyright 2017 Kuromatch
                                                                                                                                                                                                                                                                              */
i.zeroPadding=function(e,t){return(Array(t).join("0")+e).slice(-t)},i.generatePriceGrouping=function(e,t){return 1===e?function(e){return Math.round(e/t)*t}:function(i){return Math.round(i*(e/t))/(e/t)}},i.toStringWithSign=function(e){return(e>0?"+":"")+e.toString(10)},i.copyTextToClipboard=function(e){var t=r.default.createElement("span").insertText(e).insertTo(document.body),i=document.createRange();i.selectNode(t);var n=window.getSelection();n.removeAllRanges(),n.addRange(i),document.execCommand("copy"),t.remove()},i.deepCopy=n;var r=function(e){return e&&e.__esModule?e:{default:e}}(e("flagrate/lib/es6/flagrate"))},{"flagrate/lib/es6/flagrate":8}],7:[function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function i(e,t){var i,n,s,r,o,a,l,c,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),x?d(t,h):t;if(l=e.d,c=t.d,o=e.e,s=t.e,l=l.slice(),r=o-s){for(r<0?(n=l,r=-r,a=c.length):(n=c,s=o,a=l.length),r>(a=(o=Math.ceil(h/P))>a?o+1:a+1)&&(r=a,n.length=1),n.reverse();r--;)n.push(0);n.reverse()}for((a=l.length)-(r=c.length)<0&&(r=a,n=c,c=l,l=n),i=0;r;)i=(l[--r]=l[r]+c[r]+i)/N|0,l[r]%=N;for(i&&(l.unshift(i),++s),a=l.length;0==l[--a];)l.pop();return t.d=l,t.e=s,x?d(t,h):t}function s(e,t,i){if(e!==~~e||e<t||e>i)throw Error(k+e)}function r(e){var t,i,n,s=e.length-1,r="",o=e[0];if(s>0){for(r+=o,t=1;t<s;t++)n=e[t]+"",(i=P-n.length)&&(r+=c(i)),r+=n;o=e[t],(i=P-(n=o+"").length)&&(r+=c(i))}else if(0===o)return"0";for(;o%10==0;)o/=10;return r+o}function o(e,t){var i,n,s,o,l,c=0,u=0,h=e.constructor,f=h.precision;if(a(e)>16)throw Error(S+a(e));if(!e.s)return new h(_);for(null==t?(x=!1,l=f):l=t,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(l+=Math.log(T(2,u))/Math.LN10*2+5|0,i=n=s=new h(_),h.precision=l;;){if(n=d(n.times(e),l),i=i.times(++c),o=s.plus(A(n,i,l)),r(o.d).slice(0,l)===r(s.d).slice(0,l)){for(;u--;)s=d(s.times(s),l);return h.precision=f,null==t?(x=!0,d(s,f)):s}s=o}}function a(e){for(var t=e.e*P,i=e.d[0];i>=10;i/=10)t++;return t}function l(e,t,i){if(t>e.LN10.sd())throw x=!0,i&&(e.precision=i),Error(w+"LN10 precision limit exceeded");return d(new e(e.LN10),t)}function c(e){for(var t="";e--;)t+="0";return t}function u(e,t){var i,n,s,o,c,h,f,g,p,m=1,v=e,b=v.d,y=v.constructor,k=y.precision;if(v.s<1)throw Error(w+(v.s?"NaN":"-Infinity"));if(v.eq(_))return new y(0);if(null==t?(x=!1,g=k):g=t,v.eq(10))return null==t&&(x=!0),l(y,g);if(g+=10,y.precision=g,i=r(b),n=i.charAt(0),o=a(v),!(Math.abs(o)<15e14))return f=l(y,g+2,k).times(o+""),v=u(new y(n+"."+i.slice(1)),g-10).plus(f),y.precision=k,null==t?(x=!0,d(v,k)):v;for(;n<7&&1!=n||1==n&&i.charAt(1)>3;)n=(i=r((v=v.times(e)).d)).charAt(0),m++;for(o=a(v),n>1?(v=new y("0."+i),o++):v=new y(n+"."+i.slice(1)),h=c=v=A(v.minus(_),v.plus(_),g),p=d(v.times(v),g),s=3;;){if(c=d(c.times(p),g),f=h.plus(A(c,new y(s),g)),r(f.d).slice(0,g)===r(h.d).slice(0,g))return h=h.times(2),0!==o&&(h=h.plus(l(y,g+2,k).times(o+""))),h=A(h,new y(m),g),y.precision=k,null==t?(x=!0,d(h,k)):h;h=f,s+=2}}function h(e,t){var i,n,s;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(i<0&&(i=n),i+=+t.slice(n+1),t=t.substring(0,n)):i<0&&(i=t.length),n=0;48===t.charCodeAt(n);)++n;for(s=t.length;48===t.charCodeAt(s-1);)--s;if(t=t.slice(n,s)){if(s-=n,i=i-n-1,e.e=C(i/P),e.d=[],n=(i+1)%P,i<0&&(n+=P),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=P;n<s;)e.d.push(+t.slice(n,n+=P));t=t.slice(n),n=P-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),x&&(e.e>M||e.e<-M))throw Error(S+i)}else e.s=0,e.e=0,e.d=[0];return e}function d(e,t,i){var n,s,r,o,l,c,u,h,d=e.d;for(o=1,r=d[0];r>=10;r/=10)o++;if((n=t-o)<0)n+=P,s=t,u=d[h=0];else{if(h=Math.ceil((n+1)/P),r=d.length,h>=r)return e;for(u=r=d[h],o=1;r>=10;r/=10)o++;s=(n%=P)-P+o}if(void 0!==i&&(l=u/(r=T(10,o-s-1))%10|0,c=t<0||void 0!==d[h+1]||u%r,c=i<4?(l||c)&&(0==i||i==(e.s<0?3:2)):l>5||5==l&&(4==i||c||6==i&&(n>0?s>0?u/T(10,o-s):0:d[h-1])%10&1||i==(e.s<0?8:7))),t<1||!d[0])return c?(r=a(e),d.length=1,t=t-r-1,d[0]=T(10,(P-t%P)%P),e.e=C(-t/P)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(0==n?(d.length=h,r=1,h--):(d.length=h+1,r=T(10,P-n),d[h]=s>0?(u/T(10,o-s)%T(10,s)|0)*r:0),c)for(;;){if(0==h){(d[0]+=r)==N&&(d[0]=1,++e.e);break}if(d[h]+=r,d[h]!=N)break;d[h--]=0,r=1}for(n=d.length;0===d[--n];)d.pop();if(x&&(e.e>M||e.e<-M))throw Error(S+a(e));return e}function f(e,t){var i,n,s,r,o,a,l,c,u,h,f=e.constructor,g=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),x?d(t,g):t;if(l=e.d,h=t.d,n=t.e,c=e.e,l=l.slice(),o=c-n){for((u=o<0)?(i=l,o=-o,a=h.length):(i=h,n=c,a=l.length),o>(s=Math.max(Math.ceil(g/P),a)+2)&&(o=s,i.length=1),i.reverse(),s=o;s--;)i.push(0);i.reverse()}else{for((u=(s=l.length)<(a=h.length))&&(a=s),s=0;s<a;s++)if(l[s]!=h[s]){u=l[s]<h[s];break}o=0}for(u&&(i=l,l=h,h=i,t.s=-t.s),a=l.length,s=h.length-a;s>0;--s)l[a++]=0;for(s=h.length;s>o;){if(l[--s]<h[s]){for(r=s;r&&0===l[--r];)l[r]=N-1;--l[r],l[s]+=N}l[s]-=h[s]}for(;0===l[--a];)l.pop();for(;0===l[0];l.shift())--n;return l[0]?(t.d=l,t.e=n,x?d(t,g):t):new f(0)}function g(e,t,i){var n,s=a(e),o=r(e.d),l=o.length;return t?(i&&(n=i-l)>0?o=o.charAt(0)+"."+o.slice(1)+c(n):l>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(s<0?"e":"e+")+s):s<0?(o="0."+c(-s-1)+o,i&&(n=i-l)>0&&(o+=c(n))):s>=l?(o+=c(s+1-l),i&&(n=i-s-1)>0&&(o=o+"."+c(n))):((n=s+1)<l&&(o=o.slice(0,n)+"."+o.slice(n)),i&&(n=i-l)>0&&(s+1===l&&(o+="."),o+=c(n))),e.s<0?"-"+o:o}function p(e,t){if(e.length>t)return e.length=t,!0}function m(e){function t(e){var i=this;if(!(i instanceof t))return new t(e);if(i.constructor=t,e instanceof t)return i.s=e.s,i.e=e.e,void(i.d=(e=e.d)?e.slice():e);if("number"==typeof e){if(0*e!=0)throw Error(k+e);if(e>0)i.s=1;else{if(!(e<0))return i.s=0,i.e=0,void(i.d=[0]);e=-e,i.s=-1}return e===~~e&&e<1e7?(i.e=0,void(i.d=[e])):h(i,e.toString())}if("string"!=typeof e)throw Error(k+e);if(45===e.charCodeAt(0)?(e=e.slice(1),i.s=-1):i.s=1,!E.test(e))throw Error(k+e);h(i,e)}var i,n,s;if(t.prototype=O,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.clone=m,t.config=t.set=v,void 0===e&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],i=0;i<s.length;)e.hasOwnProperty(n=s[i++])||(e[n]=this[n]);return t.config(e),t}function v(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))throw Error(w+"Object expected");var t,i,s,r=["precision",1,b,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<r.length;t+=3)if(void 0!==(s=e[i=r[t]])){if(!(C(s)===s&&s>=r[t+1]&&s<=r[t+2]))throw Error(k+i+": "+s);this[i]=s}if(void 0!==(s=e[i="LN10"])){if(s!=Math.LN10)throw Error(k+i+": "+s);this[i]=new this(s)}return this}var _,b=1e9,y={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},x=!0,w="[DecimalError] ",k=w+"Invalid argument: ",S=w+"Exponent out of range: ",C=Math.floor,T=Math.pow,E=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,N=1e7,P=7,M=C(9007199254740991/P),O={};O.absoluteValue=O.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},O.comparedTo=O.cmp=function(e){var t,i,n,s,r=this;if(e=new r.constructor(e),r.s!==e.s)return r.s||-e.s;if(r.e!==e.e)return r.e>e.e^r.s<0?1:-1;for(t=0,i=(n=r.d.length)<(s=e.d.length)?n:s;t<i;++t)if(r.d[t]!==e.d[t])return r.d[t]>e.d[t]^r.s<0?1:-1;return n===s?0:n>s^r.s<0?1:-1},O.decimalPlaces=O.dp=function(){var e=this,t=e.d.length-1,i=(t-e.e)*P;if(t=e.d[t])for(;t%10==0;t/=10)i--;return i<0?0:i},O.dividedBy=O.div=function(e){return A(this,new this.constructor(e))},O.dividedToIntegerBy=O.idiv=function(e){var t=this.constructor;return d(A(this,new t(e),0,1),t.precision)},O.equals=O.eq=function(e){return!this.cmp(e)},O.exponent=function(){return a(this)},O.greaterThan=O.gt=function(e){return this.cmp(e)>0},O.greaterThanOrEqualTo=O.gte=function(e){return this.cmp(e)>=0},O.isInteger=O.isint=function(){return this.e>this.d.length-2},O.isNegative=O.isneg=function(){return this.s<0},O.isPositive=O.ispos=function(){return this.s>0},O.isZero=function(){return 0===this.s},O.lessThan=O.lt=function(e){return this.cmp(e)<0},O.lessThanOrEqualTo=O.lte=function(e){return this.cmp(e)<1},O.logarithm=O.log=function(e){var t,i=this,n=i.constructor,s=n.precision,r=s+5;if(void 0===e)e=new n(10);else if((e=new n(e)).s<1||e.eq(_))throw Error(w+"NaN");if(i.s<1)throw Error(w+(i.s?"NaN":"-Infinity"));return i.eq(_)?new n(0):(x=!1,t=A(u(i,r),u(e,r),r),x=!0,d(t,s))},O.minus=O.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?f(t,e):i(t,(e.s=-e.s,e))},O.modulo=O.mod=function(e){var t,i=this,n=i.constructor,s=n.precision;if(!(e=new n(e)).s)throw Error(w+"NaN");return i.s?(x=!1,t=A(i,e,0,1).times(e),x=!0,i.minus(t)):d(new n(i),s)},O.naturalExponential=O.exp=function(){return o(this)},O.naturalLogarithm=O.ln=function(){return u(this)},O.negated=O.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},O.plus=O.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?i(t,e):f(t,(e.s=-e.s,e))},O.precision=O.sd=function(e){var t,i,n,s=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(k+e);if(t=a(s)+1,n=s.d.length-1,i=n*P+1,n=s.d[n]){for(;n%10==0;n/=10)i--;for(n=s.d[0];n>=10;n/=10)i++}return e&&t>i?t:i},O.squareRoot=O.sqrt=function(){var e,t,i,n,s,o,l,c=this,u=c.constructor;if(c.s<1){if(!c.s)return new u(0);throw Error(w+"NaN")}for(e=a(c),x=!1,0==(s=Math.sqrt(+c))||s==1/0?(((t=r(c.d)).length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=C((e+1)/2)-(e<0||e%2),n=new u(t=s==1/0?"1e"+e:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+e)):n=new u(s.toString()),s=l=(i=u.precision)+3;;)if(o=n,n=o.plus(A(c,o,l+2)).times(.5),r(o.d).slice(0,l)===(t=r(n.d)).slice(0,l)){if(t=t.slice(l-3,l+1),s==l&&"4999"==t){if(d(o,i+1,0),o.times(o).eq(c)){n=o;break}}else if("9999"!=t)break;l+=4}return x=!0,d(n,i)},O.times=O.mul=function(e){var t,i,n,s,r,o,a,l,c,u=this,h=u.constructor,f=u.d,g=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,i=u.e+e.e,(l=f.length)<(c=g.length)&&(r=f,f=g,g=r,o=l,l=c,c=o),r=[],n=o=l+c;n--;)r.push(0);for(n=c;--n>=0;){for(t=0,s=l+n;s>n;)a=r[s]+g[n]*f[s-n-1]+t,r[s--]=a%N|0,t=a/N|0;r[s]=(r[s]+t)%N|0}for(;!r[--o];)r.pop();return t?++i:r.shift(),e.d=r,e.e=i,x?d(e,h.precision):e},O.toDecimalPlaces=O.todp=function(e,t){var i=this,n=i.constructor;return i=new n(i),void 0===e?i:(s(e,0,b),void 0===t?t=n.rounding:s(t,0,8),d(i,e+a(i)+1,t))},O.toExponential=function(e,t){var i,n=this,r=n.constructor;return void 0===e?i=g(n,!0):(s(e,0,b),void 0===t?t=r.rounding:s(t,0,8),i=g(n=d(new r(n),e+1,t),!0,e+1)),i},O.toFixed=function(e,t){var i,n,r=this,o=r.constructor;return void 0===e?g(r):(s(e,0,b),void 0===t?t=o.rounding:s(t,0,8),n=d(new o(r),e+a(r)+1,t),i=g(n.abs(),!1,e+a(n)+1),r.isneg()&&!r.isZero()?"-"+i:i)},O.toInteger=O.toint=function(){var e=this,t=e.constructor;return d(new t(e),a(e)+1,t.rounding)},O.toNumber=function(){return+this},O.toPower=O.pow=function(e){var t,i,n,s,r,a,l=this,c=l.constructor,h=+(e=new c(e));if(!e.s)return new c(_);if(!(l=new c(l)).s){if(e.s<1)throw Error(w+"Infinity");return l}if(l.eq(_))return l;if(n=c.precision,e.eq(_))return d(l,n);if(t=e.e,i=e.d.length-1,a=t>=i,r=l.s,a){if((i=h<0?-h:h)<=9007199254740991){for(s=new c(_),t=Math.ceil(n/P+4),x=!1;i%2&&p((s=s.times(l)).d,t),0!==(i=C(i/2));)p((l=l.times(l)).d,t);return x=!0,e.s<0?new c(_).div(s):d(s,n)}}else if(r<0)throw Error(w+"NaN");return r=r<0&&1&e.d[Math.max(t,i)]?-1:1,l.s=1,x=!1,s=e.times(u(l,n+12)),x=!0,s=o(s),s.s=r,s},O.toPrecision=function(e,t){var i,n,r=this,o=r.constructor;return void 0===e?n=g(r,(i=a(r))<=o.toExpNeg||i>=o.toExpPos):(s(e,1,b),void 0===t?t=o.rounding:s(t,0,8),n=g(r=d(new o(r),e,t),e<=(i=a(r))||i<=o.toExpNeg,e)),n},O.toSignificantDigits=O.tosd=function(e,t){var i=this.constructor;return void 0===e?(e=i.precision,t=i.rounding):(s(e,1,b),void 0===t?t=i.rounding:s(t,0,8)),d(new i(this),e,t)},O.toString=O.valueOf=O.val=O.toJSON=function(){var e=this,t=a(e),i=e.constructor;return g(e,t<=i.toExpNeg||t>=i.toExpPos)};var A=function(){function e(e,t){var i,n=0,s=e.length;for(e=e.slice();s--;)i=e[s]*t+n,e[s]=i%N|0,n=i/N|0;return n&&e.unshift(n),e}function t(e,t,i,n){var s,r;if(i!=n)r=i>n?1:-1;else for(s=r=0;s<i;s++)if(e[s]!=t[s]){r=e[s]>t[s]?1:-1;break}return r}function i(e,t,i){for(var n=0;i--;)e[i]-=n,n=e[i]<t[i]?1:0,e[i]=n*N+e[i]-t[i];for(;!e[0]&&e.length>1;)e.shift()}return function(n,s,r,o){var l,c,u,h,f,g,p,m,v,_,b,y,x,k,S,C,T,E,M=n.constructor,O=n.s==s.s?1:-1,A=n.d,H=s.d;if(!n.s)return new M(n);if(!s.s)throw Error(w+"Division by zero");for(c=n.e-s.e,T=H.length,S=A.length,m=(p=new M(O)).d=[],u=0;H[u]==(A[u]||0);)++u;if(H[u]>(A[u]||0)&&--c,(y=null==r?r=M.precision:o?r+(a(n)-a(s))+1:r)<0)return new M(0);if(y=y/P+2|0,u=0,1==T)for(h=0,H=H[0],y++;(u<S||h)&&y--;u++)x=h*N+(A[u]||0),m[u]=x/H|0,h=x%H|0;else{for((h=N/(H[0]+1)|0)>1&&(H=e(H,h),A=e(A,h),T=H.length,S=A.length),k=T,_=(v=A.slice(0,T)).length;_<T;)v[_++]=0;(E=H.slice()).unshift(0),C=H[0],H[1]>=N/2&&++C;do{h=0,(l=t(H,v,T,_))<0?(b=v[0],T!=_&&(b=b*N+(v[1]||0)),(h=b/C|0)>1?(h>=N&&(h=N-1),1==(l=t(f=e(H,h),v,g=f.length,_=v.length))&&(h--,i(f,T<g?E:H,g))):(0==h&&(l=h=1),f=H.slice()),(g=f.length)<_&&f.unshift(0),i(v,f,_),-1==l&&(l=t(H,v,T,_=v.length))<1&&(h++,i(v,T<_?E:H,_)),_=v.length):0===l&&(h++,v=[0]),m[u++]=h,l&&v[0]?v[_++]=A[k]||0:(v=[A[k]],_=1)}while((k++<S||void 0!==v[0])&&y--)}return m[0]||m.shift(),p.e=c,d(p,o?r+a(p)+1:r)}}();(y=m(y)).default=y.Decimal=y,_=new y(1),"function"==typeof define&&define.amd?define(function(){return y}):void 0!==t&&t.exports?t.exports=y:(e||(e="undefined"!=typeof self&&self&&self.self==self?self:Function("return this")()),e.Decimal=y)}(void 0)},{}],8:[function(e,t,i){/*!
   Copyright 2016 Webnium

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
*/
"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}Object.defineProperty(i,"__esModule",{value:!0}),i.Flagrate=void 0;var s=n(e("./flagrate/util")),r=n(e("./flagrate/element")),o=n(e("./flagrate/button")),a=n(e("./flagrate/buttons")),l=n(e("./flagrate/menu")),c=n(e("./flagrate/pulldown")),u=n(e("./flagrate/text-input")),h=n(e("./flagrate/tokenizer")),d=n(e("./flagrate/text-area")),f=n(e("./flagrate/combo-box")),g=n(e("./flagrate/select")),p=n(e("./flagrate/context-menu")),m=n(e("./flagrate/toolbar")),v=n(e("./flagrate/search-box")),_=n(e("./flagrate/checkbox")),b=n(e("./flagrate/checkboxes")),y=n(e("./flagrate/radio")),x=n(e("./flagrate/radios")),w=n(e("./flagrate/switch")),k=n(e("./flagrate/progress")),S=n(e("./flagrate/slider")),C=n(e("./flagrate/tab")),T=n(e("./flagrate/popover")),E=n(e("./flagrate/tutorial")),N=n(e("./flagrate/notify")),P=n(e("./flagrate/modal")),M=n(e("./flagrate/grid")),O=n(e("./flagrate/form")),A=i.Flagrate=void 0;!function(e){e.identity=s.identity,e.extendObject=s.extendObject,e.emptyFunction=s.emptyFunction,e.jsonPointer=s.jsonPointer,e.Element=r.Element,e.createElement=r.createElement,e.Button=o.Button,e.createButton=o.createButton,e.Buttons=a.Buttons,e.createButtons=a.createButtons,e.Menu=l.Menu,e.createMenu=l.createMenu,e.Pulldown=c.Pulldown,e.createPulldown=c.createPulldown,e.TextInput=u.TextInput,e.createTextInput=u.createTextInput,e.Tokenizer=h.Tokenizer,e.createTokenizer=h.createTokenizer,e.TextArea=d.TextArea,e.createTextArea=d.createTextArea,e.ComboBox=f.ComboBox,e.createComboBox=f.createComboBox,e.Select=g.Select,e.createSelect=g.createSelect,e.ContextMenu=p.ContextMenu,e.createContextMenu=p.createContextMenu,e.Toolbar=m.Toolbar,e.createToolbar=m.createToolbar,e.SearchBox=v.SearchBox,e.createSearchBox=v.createSearchBox,e.Checkbox=_.Checkbox,e.createCheckbox=_.createCheckbox,e.Checkboxes=b.Checkboxes,e.createCheckboxes=b.createCheckboxes,e.Radio=y.Radio,e.createRadio=y.createRadio,e.Radios=x.Radios,e.createRadios=x.createRadios,e.Switch=w.Switch,e.createSwitch=w.createSwitch,e.Progress=k.Progress,e.createProgress=k.createProgress,e.Slider=S.Slider,e.createSlider=S.createSlider,e.Tab=C.Tab,e.createTab=C.createTab,e.Popover=T.Popover,e.createPopover=T.createPopover,e.Tutorial=E.Tutorial,e.createTutorial=E.createTutorial,e.Notify=N.Notify,e.createNotify=N.createNotify,e.Modal=P.Modal,e.createModal=P.createModal,e.Grid=M.Grid,e.createGrid=M.createGrid,e.Form=O.Form,e.createForm=O.createForm}(A||(i.Flagrate=A={})),void 0===window.flagrate&&(window.flagrate=A),i.default=A},{"./flagrate/button":9,"./flagrate/buttons":10,"./flagrate/checkbox":11,"./flagrate/checkboxes":12,"./flagrate/combo-box":13,"./flagrate/context-menu":14,"./flagrate/element":15,"./flagrate/form":16,"./flagrate/grid":17,"./flagrate/menu":18,"./flagrate/modal":19,"./flagrate/notify":20,"./flagrate/popover":21,"./flagrate/progress":22,"./flagrate/pulldown":23,"./flagrate/radio":24,"./flagrate/radios":25,"./flagrate/search-box":26,"./flagrate/select":27,"./flagrate/slider":28,"./flagrate/switch":29,"./flagrate/tab":30,"./flagrate/text-area":31,"./flagrate/text-input":32,"./flagrate/tokenizer":33,"./flagrate/toolbar":34,"./flagrate/tutorial":35,"./flagrate/util":36}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,i.createButton=function(e){return new r(e)};var n=e("./util"),s=e("./element"),r=i.Button=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.isRemovableByUser=e.isRemovableByUser||!1,this.onSelect=e.onSelect||n.emptyFunction,this.onRemove=e.onRemove||n.emptyFunction;var t=e.attribute||{};e.id&&(t.id=e.id),e.isFocused&&(t.autofocus=!0),t.type||(t.type="button");var i=new s.Element("button",t);return(0,n.extendObject)(i,this),i.labelElement=new s.Element("span").insertTo(i),e.label?i.labelElement.insertText(e.label):e.labelHTML&&i.labelElement.insert(e.labelHTML),i.addClassName("flagrate flagrate-button"),e.className&&i.addClassName(e.className),i.addEventListener("click",i._onSelectHandler.bind(i),!0),e.isRemovableByUser&&(i.addClassName("flagrate-button-removable"),i._removeButton=new s.Element("button",{type:"button",class:"flagrate-button-remove"}).insertTo(i),i._removeButton.addEventListener("click",i._onRemoveHandler.bind(i),!0)),e.style&&i.setStyle(e.style),e.color&&i.setColor(e.color),e.icon&&i.setIcon(e.icon),e.isDisabled&&i.disable(),i};r.prototype={select:function(){return this._onSelectHandler(null)},disable:function(){return this.addClassName("flagrate-disabled"),this.writeAttribute("disabled",!0),this},enable:function(){return this.removeClassName("flagrate-disabled"),this.writeAttribute("disabled",!1),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},setLabel:function(e){return this.labelElement.updateText(e),this},setLabelHTML:function(e){return this.labelElement.update(e),this},setColor:function(e){if("@"===e.charAt(0))this.style.backgroundColor="",this.style.color="",this.addClassName("flagrate-button-color-"+e.slice(1));else if(this.style.backgroundColor=e,!0===/^#[0-9a-f]{6}$/i.test(e)){var t=parseInt(e.slice(1),16);this.style.color=((t>>16)+(t>>8&255)+(255&t))/3>150?"black":"white"}else this.style.color="";return this._color=e,this},getColor:function(){return this._color||""},setIcon:function(e){return this._iconIdentifier=e,e?this.addClassName("flagrate-icon").setStyle({backgroundImage:"url("+e+")"}):this.removeClassName("flagrate-icon").setStyle({backgroundImage:"none"})},getIcon:function(){return this._iconIdentifier||""},_onSelectHandler:function(e){if(!1!==this.isEnabled()){if(this._removeButton&&e&&e.layerX){var t=this.getWidth(),i=this.getHeight(),n=null===this._removeButton.getStyle("margin-right")?0:parseInt(this._removeButton.getStyle("margin-right").replace("px",""),10),s=this._removeButton.getWidth(),r=this._removeButton.getHeight(),o=e.layerX,a=e.layerY;if(o>t-n-s&&o<t-n&&a>i-(i-r)/2-r&&a<i-(i-r)/2)return this._onRemoveHandler(e),this}var l=e;l.targetButton=this,this.onSelect(l,this),this.fire("select",{targetButton:this})}},_onRemoveHandler:function(e){if(!0===this.isEnabled()){this.remove();var t=e;t.targetButton=this,this.onRemove(t,this),this.fire("remove",{targetButton:this})}}}},{"./element":15,"./util":36}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Buttons=void 0,i.createButtons=function(e){return new o(e)};var n=e("./util"),s=e("./element"),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./button")),o=i.Buttons=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.items=e.items||[],this.onSelect=e.onSelect||n.emptyFunction;var t=e.attribute||{};e.id&&(t.id=e.id);var i=new s.Element("div",t);(0,n.extendObject)(i,this),i.addClassName("flagrate flagrate-buttons"),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style);for(var r=0,o=e.items.length;r<o;r++)i.push(e.items[r]);return i.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()}),i};o.prototype={push:function(e){var t=this,i=e.onSelect;e.onSelect=function(e,n){i&&i.call(n,e,n),t.onSelect(e,t)};var n=new r.Button(e).insertTo(this);return e.key&&(n.dataset._key=e.key),this},getButtonByKey:function(e){for(var t=this.childNodes,i=0,n=t.length;i<n;i++)if(t[i].dataset._key===e)return t[i];return null},getButtons:function(){return this.childNodes||[]}}},{"./button":9,"./element":15,"./util":36}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Checkbox=void 0,i.createCheckbox=function(e){return new o(e)};var n=e("./util"),s=e("./element"),r=0,o=i.Checkbox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="flagrate-checkbox-"+(++r).toString(10),i=e.attribute||{};i.id=e.id||null,i.class=e.className||null;var o=new s.Element("label",i);return o.writeAttribute("for",t),(0,n.extendObject)(o,this),e.label?o.insertText(e.label):e.labelHTML&&o.insert(e.labelHTML),o.addClassName("flagrate flagrate-checkbox"),e.icon&&(o.addClassName("flagrate-icon"),o.setStyle({backgroundImage:"url("+e.icon+")"})),o.onChange=e.onChange||null,o.onCheck=e.onCheck||null,o.onUncheck=e.onUncheck||null,o._input=new s.Element("input",{id:t,type:"checkbox"}),o.insert({top:new s.Element}),o.insert({top:o._input}),o._input.addEventListener("change",function(e){e.stopPropagation();var t=e;t.targetCheckbox=o,!0===o.isChecked()?(o.onCheck&&o.onCheck(t,o),o.fire("check",{targetCheckbox:o})):(o.onUncheck&&o.onUncheck(t,o),o.fire("uncheck",{targetCheckbox:o})),o.onChange&&o.onChange(t,o),o.fire("change",{targetCheckbox:o})}),!0===e.isChecked&&o.check(),!0===e.isFocused&&o.focus(),!0===e.isDisabled&&o.disable(),o};o.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this._input.writeAttribute("disabled",!0),this},enable:function(){return this.removeClassName("flagrate-disabled"),this._input.writeAttribute("disabled",!1),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},isChecked:function(){return!!this._input.checked},check:function(){return this._input.checked=!0,this},uncheck:function(){return this._input.checked=!1,this}}},{"./element":15,"./util":36}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Checkboxes=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.createCheckboxes=function(e){return new a(e)};var s=e("./util"),r=e("./element"),o=e("./checkbox"),a=i.Checkboxes=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.attribute||{};e.id&&(t.id=e.id);var i=new r.Element("div",t);return(0,s.extendObject)(i,this),i.addClassName("flagrate flagrate-checkboxes"),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style),i.onChange=e.onChange,i._items=[],(e.items||[]).forEach(function(e){var t={};"object"===(void 0===e?"undefined":n(e))?(0,s.extendObject)(t,e):(t.label="string"==typeof e?e:e.toString(),t.value=e),t._checkbox=new o.Checkbox(t).insertTo(i),t._checkbox.addEventListener("change",function(e){i.onChange&&i.onChange(e,i)}),i._items.push(t)}),e.isDisabled&&i.disable(),e.values&&i.setValues(e.values),i};a.prototype={select:function(e){return this._items[e]&&this._items[e]._checkbox.check(),this},deselect:function(e){return this._items[e]&&this._items[e]._checkbox.uncheck(),this},getValues:function(){for(var e=[],t=0,i=this._items.length;t<i;t++)!0===this._items[t]._checkbox.isChecked()&&e.push(this._items[t].value);return e},addValue:function(e){for(var t=0,i=this._items.length;t<i;t++)if(this._items[t].value===e){this.select(t);break}return this},removeValue:function(e){for(var t=0,i=this._items.length;t<i;t++)if(this._items[t].value===e){this.deselect(t);break}return this},setValues:function(e){for(var t=0,i=this._items.length;t<i;t++)-1===e.indexOf(this._items[t].value)?this.deselect(t):this.select(t);return this},selectAll:function(){for(var e=0,t=this._items.length;e<t;e++)this.select(e);return this},deselectAll:function(){return this.setValues([])},enable:function(){for(var e=0,t=this._items.length;e<t;e++)this._items[e]._checkbox.enable();return this.removeClassName("flagrate-disabled"),this},disable:function(){for(var e=0,t=this._items.length;e<t;e++)this._items[e]._checkbox.disable();return this.addClassName("flagrate-disabled"),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")}}},{"./checkbox":11,"./element":15,"./util":36}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ComboBox=void 0,i.createComboBox=function(e){return new l(e)};var n=e("./util"),s=e("./element"),r=e("./button"),o=e("./menu"),a=e("./text-input"),l=i.ComboBox=function(){function e(e){return function(){l.setValue(e),l._textinput.focus(),l.fire("change")}}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.items=t.items||[],this.regexp=t.regexp||null;var i=t.attribute||{};t.id&&(i.id=t.id);var l=new s.Element("div",i);return l._textinput=new a.TextInput({value:t.value,placeholder:t.placeholder,icon:t.icon}).insertTo(l),l._button=new r.Button({onSelect:function(){function t(e){document.body.removeEventListener("click",t),l.parentNode.removeEventListener("click",t),l.off("click",t),r.style.opacity="0",setTimeout(function(){return r.remove()},500),delete l._menu}if(l._menu)return l._menu.remove(),void delete l._menu;for(var i=[],n=0,s=l.items.length;n<s;n++)i.push({label:l.items[n],onSelect:e(l.items[n])});var r=l._menu=new o.Menu({className:"flagrate-combobox-menu",items:i,onSelect:function(){r.remove(),delete l._menu}}).insertTo(l),a=r.getHeight(),c=parseInt(r.getStyle("margin-top").replace("px",""),10),u=l.cumulativeOffset().top,h=-window.pageYOffset+u,d=window.pageYOffset+window.innerHeight-u-l.getHeight();a+c>d&&(h>d?(h<a+c&&(a=h-c-c,r.style.maxHeight=a+"px"),r.addClassName("flagrate-combobox-menu-upper")):(a=d-c-c,r.style.maxHeight=a+"px")),setTimeout(function(){document.body.addEventListener("click",t),l.parentNode.addEventListener("click",t),l.on("click",t)},0)}}).insertTo(l),(0,n.extendObject)(l,this),l.addClassName("flagrate flagrate-combobox"),t.className&&l.addClassName(t.className),t.style&&l.setStyle(t.style),t.isDisabled&&l.disable(),l};l.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this._textinput.disable(),this._button.disable(),this},enable:function(){return this.removeClassName("flagrate-disabled"),this._textinput.enable(),this._button.enable(),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},getValue:function(){return this._textinput.value},setValue:function(e){return this._textinput.value=e,this},setIcon:function(e){return this._textinput.setIcon(e),this},getIcon:function(){return this._textinput.getIcon()},isValid:function(){return this.regexp.test(this.getValue())}}},{"./button":9,"./element":15,"./menu":18,"./text-input":32,"./util":36}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ContextMenu=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createContextMenu=function(e){return new r(e)};var s=e("./menu"),r=i.ContextMenu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._openHandler=this.open.bind(this),this._closeHandler=this.close.bind(this),this.items=t.items||[],this._isShowing=!1,this.setTarget(t.target||document.body)}return n(e,[{key:"setTarget",value:function(e){return this._target&&this._target.removeEventListener("contextmenu",this._openHandler),e.addEventListener("contextmenu",this._openHandler),this._target=e,this}},{key:"open",value:function(e){e&&e.preventDefault&&e.preventDefault(),!0===this._isShowing&&this.close(),this._isShowing=!0,this._menu=new s.Menu({className:"flagrate-context-menu",items:this.items,onSelect:this._closeHandler});var t=0,i=0;return e&&e.clientX&&e.clientY&&(t=e.clientX,i=e.clientY),this._menu.style.opacity="0",this._menu.insertTo(document.body),t+this._menu.getWidth()>window.innerWidth&&(t=t-this._menu.getWidth()+1),i+this._menu.getHeight()>window.innerHeight&&(i=i-this._menu.getHeight()+1),this._menu.style.top=i+"px",this._menu.style.left=t+"px",this._menu.style.opacity="1",document.body.addEventListener("click",this._closeHandler),document.body.addEventListener("mouseup",this._closeHandler),document.body.addEventListener("mousewheel",this._closeHandler),this}},{key:"close",value:function(){document.body.removeEventListener("click",this._closeHandler),document.body.removeEventListener("mouseup",this._closeHandler),document.body.removeEventListener("mousewheel",this._closeHandler),this._isShowing=!1;var e=this._menu;return setTimeout(function(){e&&e.remove&&e.remove()},0),delete this._menu,this}},{key:"visible",value:function(){return this._isShowing}},{key:"remove",value:function(){this._menu&&this.close(),this._target&&this._target.removeEventListener("contextmenu",this._openHandler)}}]),e}()},{"./menu":18}],15:[function(e,t,i){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(i,"__esModule",{value:!0}),i.createElement=i.Element=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e("./util"),o={},a={before:function(e,t){e.parentNode.insertBefore(t,e)},top:function(e,t){e.insertBefore(t,e.firstChild)},bottom:function(e,t){e.appendChild(t)},after:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)}},l=i.Element=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments[1],i=void 0;return o[e]?i=o[e].cloneNode(!1):t&&t.hasOwnProperty("type")||"select"===e?i=document.createElement(e):(i=document.createElement(e),o[e]=i.cloneNode(!1)),(0,r.extendObject)(i,this),t?i.writeAttribute(t):i};i.createElement=function(e,t){return new l(e,t)};l.prototype={isFlagrated:!0},l.visible=function(e){return"none"!==e.style.display},l.exists=function(e){if(e.parentNode)for(;null!==(e=e.parentNode);)if(e===document)return!0;return!1},l.toggle=function(e){return l[l.visible(e)?"hide":"show"](e)},l.hide=function(e){return e.style.display="none",e},l.show=function(e){return e.style.display="",e},l.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)},l.update=function(e,t){for(var i=e.childNodes.length;i--;)l.remove(e.childNodes[i]);return t?!0===l.isElement(t)?(e.appendChild(t),e):("string"!=typeof t&&(t=t.toString(10)),e.innerHTML=t,e):e},l.updateText=function(e,t){for(var i=e.childNodes.length;i--;)l.remove(e.childNodes[i]);return void 0===t?e:!0===l.isElement(t)&&void 0!==t.toString?l.updateText(e,t.toString()):("string"!=typeof t&&(t=t.toString(10)),e.appendChild(document.createTextNode(t)),e)},l.insert=function(e,t){"string"!=typeof t&&"number"!=typeof t&&!0!==l.isElement(t)||(t={bottom:t});var i=void 0,s=void 0,r=void 0,o=void 0;for(i in t)if(t.hasOwnProperty(i)){if(s=t[i],i=i.toLowerCase(),r=a[i],!0===l.isElement(s)){r(e,s);continue}for("string"!=typeof s&&(s=s.toString(10)),(o=new l).innerHTML=s,"top"!==i&&"after"!==i||[].concat(n(o.childNodes)).reverse();0!==o.childNodes.length;)r(e,o.childNodes[0])}return e},l.insertText=function(e,t){"string"!=typeof t&&"number"!=typeof t||(t={bottom:t});var i=void 0,n=void 0,s=void 0;for(i in t)t.hasOwnProperty(i)&&(n=t[i],i=i.toLowerCase(),s=a[i],"string"!=typeof n&&(n=n.toString(10)),s(e,document.createTextNode(n)));return e},l.insertTo=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bottom",n={};return i?n[i]=e:n.bottom=e,l.insert(t,n),e},l.readAttribute=function(e,t){return e.getAttribute(t)},l.writeAttribute=function(e,t,i){var n=void 0;"object"===(void 0===t?"undefined":s(t))?n=t:(n={})[t]=void 0===i||i;var r=void 0;for(r in n)!0===n.hasOwnProperty(r)&&(!1===(i=n[r])||null===i?e.removeAttribute(r):!0===i?e.setAttribute(r,r):void 0!==i&&e.setAttribute(r,i));return e},l.getDimensions=function(e){var t=l.getStyle(e,"display");if(t&&"none"!==t)return{width:e.offsetWidth,height:e.offsetHeight};var i={visibility:e.style.visibility,position:e.style.position,display:e.style.display},n={visibility:"hidden",display:"block"};"fixed"!==i.position&&(n.position="absolute"),l.setStyle(e,n);var s={width:e.offsetWidth,height:e.offsetHeight};return l.setStyle(e,i),s},l.getHeight=function(e){return l.getDimensions(e).height},l.getWidth=function(e){return l.getDimensions(e).width},l.cumulativeOffset=function(e){var t=0,i=0;if(e.parentNode)do{t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:i}},l.cumulativeScrollOffset=function(e){var t=0,i=0;do{t+=e.scrollTop||0,i+=e.scrollLeft||0,e=e.parentNode===document.body&&0!==document.documentElement.scrollTop?document.documentElement:e.parentNode}while(e);return{top:t,left:i}},l.hasClassName=function(e,t){return e.className.length>0&&(e.className===t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className))},l.addClassName=function(e,t){return l.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t),e},l.removeClassName=function(e,t){return e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").trim(),e},l.toggleClassName=function(e,t){return l[l.hasClassName(e,t)?"removeClassName":"addClassName"](e,t)},l.getStyle=function(e,t){t="float"===t?"cssFloat":t.replace(/-+([a-z])?/g,function(e,t){return t?t.toUpperCase():""});var i=e.style[t];if(!i||"auto"===i){var n=document.defaultView.getComputedStyle(e,null);i=n&&void 0!==n[t]&&""!==n[t]?n[t]:null}return"opacity"===t?i?parseFloat(i):1:"auto"===i?null:i},l.setStyle=function(e,t){var i=void 0;for(i in t)t.hasOwnProperty(i)&&(e.style["float"===i||"cssFloat"===i?"cssFloat":i]=t[i]);return e},l.on=function(e,t,i,n){return void 0===e._flagrateEvent&&(e._flagrateEvent={}),void 0===e._flagrateEvent[t]&&(e._flagrateEvent[t]=[]),e._flagrateEvent[t].push({listener:i,useCapture:n}),e.addEventListener(t,i,n||!1),e},l.off=function(e,t,i,n){if(!i)return void 0===e._flagrateEvent&&(e._flagrateEvent={}),void 0===e._flagrateEvent[t]&&(e._flagrateEvent[t]=[]),e._flagrateEvent[t].forEach(function(i){e.removeEventListener(t,i.listener,i.useCapture||!1)}),e;e.removeEventListener(t,i,n||!1)},l.fire=function(e,t,i){var n=document.createEvent("HTMLEvents");return n.initEvent(t,!0,!0),i&&(0,r.extendObject)(n,i),e.dispatchEvent(n),e},l.emit=l.fire;for(var c in l)c in l.prototype||(l.prototype[c]=function(e){return function(){return l[e].apply(l,[this].concat(Array.prototype.slice.call(arguments)))}}(c));l.extend=function(e){return e.isFlagrated?e:((0,r.extendObject)(e,l.prototype),e)},"object"===("undefined"==typeof HTMLElement?"undefined":s(HTMLElement))?l.isElement=function(e){return e instanceof HTMLElement}:l.isElement=function(e){return!(!e||1!==e.nodeType||"string"!=typeof e.nodeName)}},{"./util":36}],16:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Form=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createForm=function(e){return new g(e)};var s=e("./util"),r=e("./element"),o=e("./text-input"),a=e("./text-area"),l=e("./combo-box"),c=e("./checkbox"),u=e("./checkboxes"),h=e("./switch"),d=e("./radios"),f=e("./select"),g=i.Form=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._opt=t,this._fields=[],this._nolabel=!1,this._vertical=!1,this.element=new r.Element("form",{class:"flagrate flagrate-form"}),this._id="flagrate-form-"+(++e.idCounter).toString(10),!0===t.nolabel&&(this._nolabel=!0),!0===t.vertical&&(this._vertical=!0),this._create(),t.fields&&0!==t.fields.length&&this.push(t.fields)}return n(e,[{key:"insertTo",value:function(e,t){return this.element.insertTo(e,t)&&this}},{key:"on",value:function(e,t,i){return this.element.on(e,t,i)&&this}},{key:"off",value:function(e,t,i){return this.element.off(e,t,i)&&this}},{key:"getResult",value:function(){for(var e={},t=0,i=this._fields.length;t<i;t++){var n=this._fields[t];!n.key&&"string"!=typeof n.pointer||!0!==n._dependsIsOk||null!==n.pointer&&("string"==typeof n.pointer?s.jsonPointer.set(e,n.pointer,n.getVal()):n.key&&(e[n.key]=n.getVal()))}return e}},{key:"validate",value:function(e){function t(e){!1===e&&(a=!0),i()}function i(){0!==n.length?n.shift().validate(t):e&&e(!a)}for(var n=[],s=0,r=this._fields.length;s<r;s++){var o=this._fields[s];!0===o._dependsIsOk&&o.input&&o.input.type&&n.push(o)}var a=!1;return i(),this}},{key:"enable",value:function(){for(var e=0,t=this._fields.length;e<t;e++){var i=this._fields[e];i.input&&i.input.type&&i.input.type.enable.call(i.input)}return this}},{key:"disable",value:function(){for(var e=0,t=this._fields.length;e<t;e++){var i=this._fields[e];i.input&&i.input.type&&i.input.type.disable.call(i.input)}return this}},{key:"getField",value:function(e){for(var t=0,i=this._fields.length;t<i;t++){var n=this._fields[t];if(n.key&&n.key===e)return n}return null}},{key:"push",value:function(e){if(e instanceof Array)for(var t=0,i=e.length;t<i;t++)this._createField(e[t]),this._fields.push(e[t]);else this._createField(e),this._fields.push(e);for(var n=0,s=this._fields.length;n<s;n++)this._collectFieldRefs(this._fields[n]),this._checkFieldDepends(this._fields[n]);return this._requestRender(),this._fields.length}},{key:"splice",value:function(e,t,i){t=void 0===t?this._fields.length-e:t;for(var n=this._fields.splice(e,t),s=0,r=n.length;s<r;s++)n[s].container&&(n[s].container.remove(),delete n[s].container);if(i){i instanceof Array==!1&&(i=[i]);for(var o=0,a=i.length;o<a;o++)this._createField(i[o]),this._fields.splice(e+o,0,i[o])}for(var l=0,c=this._fields.length;l<c;l++)this._collectFieldRefs(this._fields[l]),this._checkFieldDepends(this._fields[l]);return this._requestRender(),n}},{key:"removeField",value:function(e){var t=[],i=!0;e instanceof Array==!1&&(i=!1,e=[e]);for(var n=0,s=e.length;n<s;n++){var r="number"==typeof e[n]?e[n]:this.indexOf(e[n]);-1!==r&&t.push(this.splice(r,1))}return i?t:t[0]}},{key:"indexOf",value:function(e){if("string"==typeof e){for(var t=-1,i=0,n=this._fields.length;i<n;i++)if(this._fields[i].key===e){t=i;break}return t}return this._fields.indexOf(e)}},{key:"_create",value:function(){return this._opt.id&&this.element.writeAttribute("id",this._opt.id),this._opt.className&&this.element.addClassName(this._opt.className),this._opt.attribute&&this.element.writeAttribute(this._opt.attribute),this._opt.style&&this.element.setStyle(this._opt.style),!0===this._opt.nolabel&&this.element.addClassName("flagrate-form-nolabel"),!0===this._opt.vertical&&this.element.addClassName("flagrate-form-vertical"),this.element.addEventListener("submit",function(e){return e.preventDefault()}),this}},{key:"_requestRender",value:function(){return this._renderTimer&&clearTimeout(this._renderTimer),this._renderTimer=setTimeout(this._render.bind(this),0),this}},{key:"_render",value:function(){for(var e=document.activeElement,t=0,i=this._fields.length;t<i;t++){var n=this._fields[t];!0===n._dependsIsOk?n.container.insertTo(this.element):!0===n.visible()&&n.container.remove()}return e&&(!0===/Trident/.test(window.navigator.userAgent)?setTimeout(function(){e.focus&&e.focus();if("INPUT"===e.tagName&&("text"===e.type||"password"===e.type||"number"===e.type)||"TEXTAREA"===e.tagName)if("number"==typeof e.selectionStart)e.selectionStart=e.selectionEnd=e.value.length;else if(void 0!==e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}},0):e.focus&&e.focus()),this}},{key:"_collectFieldRefs",value:function(e){if(e._refs=[],void 0!==e.point&&(e.pointer=e.point,delete e.point),!e.key&&"string"!=typeof e.pointer)return this;var t=void 0,i=void 0,n=void 0,s=void 0,r=void 0,o=void 0,a=void 0,l=void 0;for(t=0,i=this._fields.length;t<i;t++)if(a=this._fields[t],e!==a&&a.depends&&0!==a.depends.length)for(n=0,s=a.depends.length;n<s;n++){if(a.depends[n]instanceof Array){for(l=!1,r=0,o=a.depends[n].length;r<o;r++){if(a.depends[n][r].key===e.key){l=!0;break}if("string"==typeof a.depends[n][r].point&&(a.depends[n][r].pointer=a.depends[n][r].point,delete a.depends[n][r].point),"string"==typeof a.depends[n][r].pointer){if(a.depends[n][r].pointer===e.pointer){l=!0;break}if(a.depends[n][r].pointer==="/"+e.key){l=!0;break}}}l&&e._refs.push(a);break}if(a.depends[n].key===e.key){e._refs.push(a);break}if("string"==typeof a.depends[n].point&&(a.depends[n].pointer=a.depends[n].point,delete a.depends[n].point),"string"==typeof a.depends[n].pointer){if(a.depends[n].pointer===e.pointer){e._refs.push(a);break}if(a.depends[n].pointer==="/"+e.key){e._refs.push(a);break}}}return this}},{key:"_compareDepend",value:function(e){var t=void 0;if(e.key){var i=this.getField(e.key);if(null!==i){if(!e.op&&!e.tester&&void 0===e.val)return!0;!0===i._dependsIsOk&&(t=i.getVal())}}else{if("string"!=typeof e.pointer)return!0;try{t=s.jsonPointer.get(this.getResult(),e.pointer)}catch(e){}}if("function"==typeof e.tester)return!!e.tester(t,e);if(e.op){if("==="===e.op&&e.val===t)return!0;if("!=="===e.op&&e.val!==t)return!0;if(">="===e.op&&e.val>=t)return!0;if("<="===e.op&&e.val<=t)return!0;if(">"===e.op&&e.val>t)return!0;if("<"===e.op&&e.val<t)return!0;if("in"===e.op&&void 0!==t[e.val])return!0}else if(e.val===t)return!0;return!1}},{key:"_checkFieldDepends",value:function(e){var t=e.depends;if(!t||0===t.length)return e._dependsIsOk=!0,!0;var i=!0,n=void 0,s=void 0,r=void 0,o=void 0,a=void 0,l=void 0;for(n=0,s=t.length;n<s;n++)if((a=t[n])instanceof Array){for(l=!1,r=0,o=a.length;r<o;r++)if(!0===this._compareDepend(a[r])){l=!0;break}if(!1===l){i=!1;break}}else if(!1===this._compareDepend(a)){i=!1;break}return e._dependsIsOk=i,i}},{key:"_createField",value:function(t){var i=this;if(t._dependsIsOk=!t.depends||0===t.depends.length,t.container=new r.Element("div"),t.id&&t.container.writeAttribute("id",t.id),t.className&&t.container.writeAttribute("class",t.className),t.attribute&&t.container.writeAttribute(t.attribute),t.style&&t.container.setStyle(t.style),!1===this._nolabel&&(t.labelElement=new r.Element("label").insertText(t.label||""),new r.Element("div",{class:"flagrate-form-field-label"}).insert(t.labelElement).insertTo(t.container),t.icon&&(t.labelElement.addClassName("flagrate-icon"),t.labelElement.setStyle({backgroundImage:"url("+t.icon+")"}))),t._input=new r.Element("div").insertTo(t.container),t.input&&t.input.type&&("string"==typeof t.input.type?t.input.type=e.inputType[t.input.type]:t.input.type.create||delete t.input),t.input&&t.input.type){var n=t.input;n.id||(n.id="flagrate-form-input-"+ ++e.idCounter),!1===this._nolabel&&t.labelElement.writeAttribute("for",n.id),n.element=n.type.create.call(n),new r.Element("div",{class:"flagrate-form-field-input"}).insert(n.element).insertTo(t._input),n.element.writeAttribute("id",n.id),n.value?n.val=n.value:n.values&&(n.val=n.values),void 0!==n.val&&n.type.setVal.call(n,n.val),n.style&&n.element.setStyle(n.style),n.attribute&&n.element.writeAttribute(n.attribute),"boolean"==typeof n.toString&&void 0===n.toStr&&(n.toStr=n.toString),n.validators?n.validators.forEach(function(t,i){"string"==typeof t&&(n.validators[i]=e.inputValidator[t])}):n.validators=[],n._result=new r.Element("ul",{class:"flagrate-form-field-result"}).insertTo(t._input),!0===n.isRequired&&t.container.addClassName("flagrate-required")}if(t.element&&new r.Element("div",{class:"flagrate-form-field-element"}).insert(t.element).insertTo(t._input),t.html&&new r.Element("div",{class:"flagrate-form-field-html"}).insert(t.html).insertTo(t._input),t.text&&new r.Element("p",{class:"flagrate-form-field-text"}).insertText(t.text).insertTo(t._input),t.visible=function(){return null!==t.container.parentNode&&t.container.parentNode===i.element},t.getVal=function(){if(t.input){var e=t.input.type.getVal.call(t.input);return!0===t.input.toStr&&(e=e.toString()),!0===t.input.trim&&"string"==typeof e&&(e=e.trim()),!0===t.input.toNumber&&"number"!=typeof e&&("string"==typeof e?e=parseFloat(e):e instanceof Date?e=e.getTime():"boolean"==typeof e&&(e=!0===e?1:0)),"function"==typeof t.input.transform&&(e=t.input.transform.call(t.input,e)),e}},t.setVal=function(e){return t.input?(t.input.type.setVal.call(t.input,e),t._inputOnChange(),t):t},t.validate=function(e){function i(e,i){switch(e){case!0:case"success":break;case null:case"warning":a=!0;break;case!1:case"error":o=!0}i&&new r.Element("li").insertText(i).insertTo(t.input._result),n()}function n(){if(0===l.length||!0===o)return""===t.input._result.innerHTML?t.container.removeClassName("flagrate-has-result"):t.container.addClassName("flagrate-has-result"),o?(t.container.removeClassName("flagrate-has-warning"),t.container.removeClassName("flagrate-has-success"),t.container.addClassName("flagrate-has-error")):a?(t.container.removeClassName("flagrate-has-error"),t.container.removeClassName("flagrate-has-success"),t.container.addClassName("flagrate-has-warning")):(t.container.removeClassName("flagrate-has-error"),t.container.removeClassName("flagrate-has-warning"),t.container.addClassName("flagrate-has-success")),t._hasError=o,t._hasWarning=a,void(e&&e(!o));var n=l.shift();"function"==typeof n?n.call(t.input,s,i):"string"==typeof s&&""!==s?n.regexp.test(s)?i(!0,n.success):i(!1,n.error):i(!0)}var s=t.getVal(),o=!1,a=!1;t.input._result.update(),!0===t.input.isRequired&&(void 0===s?o=!0:!1===s||null===s?o=!0:"number"==typeof s&&!0===isNaN(s)?o=!0:void 0!==s.length&&0===s.length&&(o=!0)),"number"==typeof t.input.min&&("number"==typeof s?t.input.min>s&&(o=!0):"string"==typeof s&&""!==s?t.input.min>parseInt(s,10)&&(o=!0):s instanceof Array&&t.input.min>s.length&&(o=!0)),"number"==typeof t.input.max&&("number"==typeof s?t.input.max<s&&(o=!0):"string"==typeof s&&""!==s?t.input.max<parseInt(s,10)&&(o=!0):s instanceof Array&&t.input.max<s.length&&(o=!0)),t.input.minLength&&t.input.minLength>(s.length||s.toString&&s.toString().length||0)&&"string"==typeof s&&""!==s&&(o=!0),t.input.maxLength&&t.input.maxLength<(s.length||s.toString&&s.toString().length||0)&&(o=!0);var l=[];t.input.validators.forEach(function(e){l.push(e)}),n()},t._checkRefs=function(){for(var e,n=!1,s=0,r=t._refs.length;s<r;s++)(e=t._refs[s])._dependsIsOk!==i._checkFieldDepends(e)&&(e._checkRefs(),n=!0);!0===n&&i._requestRender()},t._inputOnChange=function(){t.validate(),t._checkRefs()},t.input&&t.input.type){(t.input.type.changeEvents||["change"]).forEach(function(e){t.input.element.addEventListener(e,t._inputOnChange)})}return this}}]),e}();g.idCounter=0,g.inputValidator={numeric:{regexp:/^[0-9]+$/},alphanumeric:{regexp:/^[a-z0-9]+$/i}},g.inputType={text:{changeEvents:["change","keyup"],create:function(){return new o.TextInput({placeholder:this.placeholder,icon:this.icon,attribute:{maxlength:this.maxLength}})},getVal:function(){return this.element.getValue()},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},password:{changeEvents:["change","keyup"],create:function(){return new o.TextInput({placeholder:this.placeholder,icon:this.icon,attribute:{type:"password",maxlength:this.maxLength}})},getVal:function(){return this.element.getValue()},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},textarea:{changeEvents:["change","keyup"],create:function(){return new a.TextArea({placeholder:this.placeholder,icon:this.icon,attribute:{maxlength:this.maxLength}})},getVal:function(){return this.element.getValue()},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},number:{changeEvents:["change","keyup"],create:function(){return new o.TextInput({placeholder:this.placeholder,icon:this.icon,attribute:{type:"number",inputmode:"numeric",min:this.min,max:this.max,maxlength:this.maxLength}})},getVal:function(){return parseFloat(this.element.getValue())},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},combobox:{changeEvents:["change","keyup"],create:function(){return new l.ComboBox({placeholder:this.placeholder,icon:this.icon,items:this.items,attribute:{maxlength:this.maxLength}})},getVal:function(){return this.element.getValue()},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},checkbox:{create:function(){return new c.Checkbox({icon:this.icon,label:this.label,labelHTML:this.labelHTML})},getVal:function(){return this.element.isChecked()},setVal:function(e){e?this.element.check():this.element.uncheck()},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},checkboxes:{create:function(){return new u.Checkboxes({items:this.items})},getVal:function(){return this.element.getValues()},setVal:function(e){this.element.setValues(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},switch:{create:function(){return new h.Switch},getVal:function(){return this.element.isOn()},setVal:function(e){e?this.element.switchOn():this.element.switchOff()},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},radios:{create:function(){return new d.Radios({items:this.items})},getVal:function(){return this.element.getValue()},setVal:function(e){this.element.setValue(e)},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},select:{create:function(){return new f.Select({items:this.items,listView:this.listView,multiple:this.multiple,max:this.max,selectedIndex:this.selectedIndex,selectedIndexes:this.selectedIndexes})},getVal:function(){return!0===this.element.multiple?this.element.getValues():this.element.getValue()},setVal:function(e){!1===this.element.multiple?e=[e]:this.element.deselectAll();for(var t=0,i=e.length,n=this.element.items.length;t<i;t++)for(var s=0;s<n;s++)if(e[t]===this.element.items[s].value){this.element.select(s);break}},enable:function(){this.element.enable()},disable:function(){this.element.disable()}},file:{create:function(){return new r.Element("input",{type:"file",accept:this.accept||(this.acceptTypes?this.acceptTypes.join(","):void 0)})},getVal:function(){return this.element.files[0]},setVal:function(e){this.element.files[0]=e},enable:function(){this.element.writeAttribute("disabled",!1)},disable:function(){this.element.writeAttribute("disabled",!0)}},files:{create:function(){return new r.Element("input",{type:"file",accept:this.accept||(this.acceptTypes?this.acceptTypes.join(","):void 0),multiple:!0})},getVal:function(){return this.element.files},setVal:function(e){this.element.files=e},enable:function(){this.element.writeAttribute("disabled",!1)},disable:function(){this.element.writeAttribute("disabled",!0)}}}},{"./checkbox":11,"./checkboxes":12,"./combo-box":13,"./element":15,"./radios":25,"./select":27,"./switch":29,"./text-area":31,"./text-input":32,"./util":36}],17:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Grid=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createGrid=function(e){return new u(e)};var r=e("./element"),o=e("./button"),a=e("./checkbox"),l=e("./toolbar"),c=e("./context-menu"),u=i.Grid=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._opt=t,this._cols=[],this._rows=[],this._pagePosition=0,this._selectedRows=[],this._sortedByKey=null,this._sortedByAsc=null,this.element=new r.Element("div",{class:"flagrate flagrate-grid"}),this._head=new r.Element("div",{class:"flagrate-grid-head"}).insertTo(this.element),this._thead=new r.Element("thead").insertTo(new r.Element("table").insertTo(this._head)),this._tr=new r.Element("tr").insertTo(this._thead),this._body=new r.Element("div",{class:"flagrate-grid-body"}).insertTo(this.element),this._tbody=new r.Element("tbody").insertTo(new r.Element("table").insertTo(this._body)),this._style=new r.Element("style").insertTo(this.element),this._id="flagrate-grid-"+(++e.idCounter).toString(10),t.id&&this.element.writeAttribute("id",t.id),t.className&&this.element.addClassName(t.className),t.attribute&&this.element.writeAttribute(t.attribute),t.style&&this.element.setStyle(t.style),t.cols&&(this._cols=t.cols),t.rows&&(this._rows=t.rows),void 0===t.colMinWidth&&(t.colMinWidth=16),void 0===t.pagination&&(t.pagination=!1),t.numberOfRowsPerPage||(t.numberOfRowsPerPage=20),void 0===t.fill&&(t.fill=!1),!0===t.headless&&(t.disableSort=!0,t.disableResize=!0,this.element.addClassName("flagrate-grid-headless")),void 0===t.multiSelect&&(t.multiSelect=!1),void 0===t.disableCheckbox&&(t.disableCheckbox=!1),void 0===t.disableSelect&&(t.disableSelect=!1),void 0===t.disableSort&&(t.disableSort=!1),void 0===t.disableResize&&(t.disableResize=!1),this.onSelect=t.onSelect,this.onDeselect=t.onDeselect,this.onClick=t.onClick,this.onDblClick=t.onDblClick,this.onRender=t.onRender,this.onRendered=t.onRendered,this.postProcessOfRow=t.postProcessOfRow,this._create()._requestRender()}return s(e,[{key:"insertTo",value:function(e,t){return this.element.insertTo(e,t)&&this}},{key:"on",value:function(e,t,i){return this.element.on(e,t,i)&&this}},{key:"off",value:function(e,t,i){return this.element.off(e,t,i)&&this}},{key:"select",value:function(e){var t=this,i=void 0;if(!0===Array.isArray(e))i=e;else{i=[];for(var n=0,s=arguments.length;n<s;n++)i.push(arguments[n])}!1===this._opt.multiSelect&&this.deselectAll();for(var r=function(e,n){var s=i[e];if("number"==typeof s&&(s=t._rows[s]),s.isSelected=!0,s._tr&&!0===s._tr.hasClassName("flagrate-grid-row-selected"))return"continue";t._selectedRows.push(s),s._tr&&s._tr.addClassName("flagrate-grid-row-selected"),s._checkbox&&(s._checkbox.check(),setTimeout(function(){!0===s.isSelected&&s._checkbox.check()},0)),s.onSelect&&s.onSelect.call(t,window.event,s,t),t.onSelect&&t.onSelect(window.event,s,t)},o=0,a=i.length;o<a;o++){r(o)}return 0!==this._selectedRows.length&&this._checkbox&&this._checkbox.check(),this.element.fire("change",{targetGrid:this}),this}},{key:"deselect",value:function(e){var t=this,i=void 0;if(Array.isArray(e))i=e;else{i=[];for(var n=0,s=arguments.length;n<s;n++)i.push(arguments[n])}for(var r=function(e,n){var s=i[e];if("number"==typeof s&&(s=t._rows[s]),s.isSelected=!1,s._tr&&!1===s._tr.hasClassName("flagrate-grid-row-selected"))return"continue";t._selectedRows.splice(t._selectedRows.indexOf(s),1),s._tr&&s._tr.removeClassName("flagrate-grid-row-selected"),s._checkbox&&(s._checkbox.uncheck(),setTimeout(function(){!1===s.isSelected&&s._checkbox.uncheck()},0)),s.onDeselect&&s.onDeselect.call(t,window.event,s,t),t.onDeselect&&t.onDeselect(window.event,s,t)},o=0,a=i.length;o<a;o++){r(o)}return 0===this._selectedRows.length&&this._checkbox&&this._checkbox.uncheck(),this.element.fire("change",{targetGrid:this}),this}},{key:"selectAll",value:function(){return this.select(this._rows)}},{key:"deselectAll",value:function(){return this.deselect(this._rows)}},{key:"getSelectedRows",value:function(){return this._selectedRows}},{key:"getValues",value:function(){return this._selectedRows.map(function(e){return function(){if(void 0!==this.value)return this.value;var e={};for(var t in this.cell)"object"===n(this.cell[t])&&void 0!==this.cell[t].value&&(e[t]=this.cell[t].value);return e}.call(e)})}},{key:"sort",value:function(e,t){void 0===t&&(t=!0),this._rows.sort(function(t,i){var s=0,r=0,o=t.cell[e],a=i.cell[e];return s="object"===(void 0===o?"undefined":n(o))?void 0!==o.sortAlt?o.sortAlt:o.text||o.html||o.element&&o.element.innerHTML||o._div&&o._div.innerHTML||0:o||0,r="object"===(void 0===a?"undefined":n(a))?void 0!==a.sortAlt?a.sortAlt:a.text||a.html||a.element&&a.element.innerHTML||a._div&&a._div.innerHTML||0:a||0,s===r?0:s>r?1:-1}),!1===t&&this._rows.reverse();for(var i=0,s=this._cols.length;i<s;i++)this._cols[i].key===e?(t?(this._cols[i]._th.addClassName("flagrate-grid-col-sorted-asc"),this._cols[i]._th.removeClassName("flagrate-grid-col-sorted-desc")):(this._cols[i]._th.addClassName("flagrate-grid-col-sorted-desc"),this._cols[i]._th.removeClassName("flagrate-grid-col-sorted-asc")),this._cols[i].isSorted=!0,this._cols[i].isAsc=t,this._sortedByKey=e,this._sortedByAsc=t):(this._cols[i].isSorted&&this._cols[i]._th.removeClassName("flagrate-grid-col-sorted-asc").removeClassName("flagrate-grid-col-sorted-desc"),this._cols[i].isSorted=!1,this._cols[i].isAsc=null);return this._requestRender(),this}},{key:"unshift",value:function(e){if(!0===Array.isArray(e))for(var t=0,i=e.length;t<i;t++)this._rows.unshift(e[t]);else this._rows.unshift(e);return null===this._sortedByKey?this._requestRender():this.sort(this._sortedByKey,this._sortedByAsc),this._rows.length}},{key:"push",value:function(e){if(!0===Array.isArray(e))for(var t=0,i=e.length;t<i;t++)this._rows.push(e[t]);else this._rows.push(e);return null===this._sortedByKey?this._requestRender():this.sort(this._sortedByKey,this._sortedByAsc),this._rows.length}},{key:"shift",value:function(e){for(var t=e||1,i=[],n=0,s=this._rows.length;n<s&&n<t;n++)i.push(this._rows.shift());return this._requestRender(),e?i:i[0]}},{key:"pop",value:function(e){for(var t=e||1,i=[],n=0,s=this._rows.length;n<s&&n<t;n++)i.push(this._rows.pop());return this._requestRender(),e?i:i[0]}},{key:"splice",value:function(e,t,i){t=void 0===t?this._rows.length-e:t;var n=this._rows.splice(e,t);if(i){i instanceof Array==!1&&(i=[i]);for(var s=0,r=i.length;s<r;s++)this._rows.splice(e+s,0,i[s])}return null===this._sortedByKey?this._requestRender():this.sort(this._sortedByKey,this._sortedByAsc),n}},{key:"indexOf",value:function(e,t){return this._rows.indexOf(e,t)}},{key:"removeRow",value:function(e){var t=[],i=!0;e instanceof Array==!1&&(i=!1,e=[e]);for(var n=0,s=e.length;n<s;n++){var r=this.indexOf(e[n]);-1!==r&&t.push(this.splice(r,1))}return i?t:t[0]}},{key:"disable",value:function(){return this.element.addClassName("flagrate-disabled"),this}},{key:"enable",value:function(){return this.element.removeClassName("flagrate-disabled"),this}},{key:"isEnabled",value:function(){return!this.element.hasClassName("flagrate-disabled")}},{key:"_create",value:function(){var e=this;!1===this._opt.disableCheckbox&&!1===this._opt.disableSelect&&!0===this._opt.multiSelect&&(this._checkbox=new a.Checkbox({onCheck:this.selectAll.bind(this),onUncheck:this.deselectAll.bind(this)}).insertTo(new r.Element("th",{class:"flagrate-grid-cell-checkbox"}).insertTo(this._tr)));for(var t=0,i=this._cols.length;t<i;t++){var n=this._cols[t];n._id=this._id+"-col-"+n.key,n._th=new r.Element("th").insertTo(this._tr),n.id&&n._th.writeAttribute("id",n.id),n.className&&n._th.writeAttribute("class",n.className),n.attribute&&n._th.writeAttribute(n.attribute),n.style&&n._th.setStyle(n.style),n._th.addClassName(n._id);var s=n.width?n.width.toString(10)+"px":"auto";this._style.insertText("."+n._id+"{width:"+s+"}"),n.align&&(n._th.style.textAlign=n.align),n._div=(new r.Element).insertTo(n._th),n.label&&n._div.updateText(n.label),n.icon&&(n._div.addClassName("flagrate-icon"),n._div.setStyle({backgroundImage:"url("+n.icon+")"})),!1!==this._opt.disableResize||n.disableResize||(n._resizeHandle=new r.Element("div",{class:"flagrate-grid-col-resize-handle"}).insertTo(this.element),n._resizeHandle.onmousedown=this._createResizeHandleOnMousedownHandler(n)),!1!==this._opt.disableSort||n.disableSort||(n._th.addClassName("flagrate-grid-col-sortable"),n._th.onclick=this._createColOnClickHandler(n))}return this._lastCol=new r.Element("th",{class:this._id+"-col-last"}).insertTo(this._tr),this._style.insertText("."+this._id+"-col-last:after{right:0}"),this._opt.pagination&&(this.element.addClassName("flagrate-grid-pagination"),this._pager=new l.Toolbar({className:"flagrate-grid-pager",items:[{key:"rn",element:new r.Element("span").insertText("-")},{key:"first",element:new o.Button({className:"flagrate-grid-pager-first",onSelect:function(){e._pagePosition=0,e._requestRender()}})},{key:"prev",element:new o.Button({className:"flagrate-grid-pager-prev",onSelect:function(){--e._pagePosition,e._requestRender()}})},{key:"num",element:new r.Element("span",{class:"flagrate-grid-pager-num"}).insertText("-")},{key:"next",element:new o.Button({className:"flagrate-grid-pager-next",onSelect:function(){++e._pagePosition,e._requestRender()}})},{key:"last",element:new o.Button({className:"flagrate-grid-pager-last",onSelect:function(){e._pagePosition=Math.floor(e._rows.length/e._opt.numberOfRowsPerPage),e._requestRender()}})}]}).insertTo(this.element)),this._opt.fill?(this.element.addClassName("flagrate-grid-fill"),this._body.onscroll=this._createBodyOnScrollHandler()):this.element.onscroll=this._createOnScrollHandler(),!1===this._opt.disableResize&&this._layoutUpdater(),this}},{key:"_layoutUpdater",value:function(){var e=this;this._layoutInterval&&clearInterval(this._layoutInterval),this._layoutInterval=setInterval(function(){!1!==e.element.exists()?e._requestUpdateLayout():clearInterval(e._layoutInterval)},1e3)}},{key:"_requestUpdateLayout",value:function(){var e=this;this._layoutWidth!==this.element.clientWidth&&(this._layoutTimer&&clearTimeout(this._layoutTimer),this._layoutTimer=setTimeout(function(){e._layoutWidth=e.element.clientWidth,e._updateLayoutOfCols(),e._updatePositionOfResizeHandles()},0))}},{key:"_requestRender",value:function(){return this._renderTimer&&clearTimeout(this._renderTimer),this._renderTimer=setTimeout(this._render.bind(this),0),this}},{key:"_render",value:function(){if(this.onRender&&!1===this.onRender(this))return this;var e=!1===this._opt.disableCheckbox&&!1===this._opt.disableSelect&&!0===this._opt.multiSelect,t=void 0,i=void 0,n=void 0,s=void 0,o=void 0,l=void 0,c=void 0,u=void 0,h=void 0,g=this._rows.length,p=this._cols.length;for(this._opt.pagination&&(l=0,(c=Math.ceil(g/this._opt.numberOfRowsPerPage))<=this._pagePosition&&(this._pagePosition=c-1),this._pagePosition<=0&&(this._pagePosition=0),h=(u=this._pagePosition*this._opt.numberOfRowsPerPage)+this._opt.numberOfRowsPerPage),this._tbody.update(),t=0;t<g;t++){if(this._opt.pagination){if(t<u)continue;if(t>=h)break;++l}if((n=this._rows[t])._tr)n._tr.insertTo(this._tbody);else{for(n._grid=this,n._tr=new r.Element("tr").insertTo(this._tbody),n.id&&(n._tr.id=n.id),n.className&&(n._tr.className=n.className),n.attribute&&n._tr.writeAttribute(n.attribute),n.style&&n._tr.setStyle(n.style),(n.onClick||this.onClick||!1===this._opt.disableSelect)&&(!1===this._opt.disableSelect&&n._tr.addClassName("flagrate-grid-row-selectable"),(n.onClick||this.onClick)&&n._tr.addClassName("flagrate-grid-row-clickable"),n._tr.onclick=this._createRowOnClickHandler(n)),(n.onDblClick||this.onDblClick)&&(n._tr.ondblclick=this._createRowOnDblClickHandler(n)),e&&!n._checkbox&&(n._checkbox=new a.Checkbox({onChange:this._createRowOnCheckHandler(n)}).insertTo(new r.Element("td",{class:"flagrate-grid-cell-checkbox"}).insertTo(n._tr))),!0===n.isSelected&&this.select(n),i=0;i<p;i++)s=this._cols[i],"string"!=typeof(o=void 0===n.cell[s.key]?n.cell[s.key]={}:n.cell[s.key])&&"number"!=typeof o||(o=n.cell[s.key]={text:o}),o._td?o._td.insertTo(n._tr):(o._td=new r.Element("td").insertTo(n._tr),o.id&&(o._td.id=o.id),o.className&&(o._td.className=o.className),o.attribute&&o._td.writeAttribute(o.attribute),o.style&&o._td.setStyle(o.style),s.align&&(o._td.style.textAlign=s.align),o._td.addClassName(s._id),o._div=(new r.Element).insertTo(o._td),void 0!==o.text&&o._div.updateText(o.text),o.html&&o._div.update(o.html),o.element&&o._div.update(o.element),o.icon&&(o._div.addClassName("flagrate-icon"),o._div.style.backgroundImage="url("+o.icon+")"),o.onClick&&(o._td.addClassName("flagrate-grid-cell-clickable"),o._td.onclick=this._createCellOnClickHandler(o)),o.onDblClick&&(o._td.ondblclick=this._createCellOnDblClickHandler(o)),Object.defineProperties(o,f),o.postProcess&&o.postProcess.call(this,o._td,o,this));n._last||(n._last=new r.Element("td",{class:this._id+"-col-last"})),n._last.insertTo(n._tr),n.menuItems&&this._updateRowMenu(n,n.menuItems),Object.defineProperties(n,d),n.postProcess&&n.postProcess.call(this,n._tr,n,this),this.postProcessOfRow&&this.postProcessOfRow(n._tr,n,this)}}return this._opt.pagination&&(this._pager.getElementByKey("rn").updateText(u+1+" - "+(u+l)+" / "+g),this._pager.getElementByKey("num").updateText(this._pagePosition+1+" / "+c)),!1===this._opt.disableResize&&(this._opt.fill&&(this._head.style.right=this._body.offsetWidth-this._body.clientWidth+"px",this._head.scrollLeft=this._body.scrollLeft),this._requestUpdateLayout()),this.onRendered&&this.onRendered(this),this}},{key:"_updateRowMenu",value:function(e,t){e._menu&&(e._menu.remove(),delete e._menu),t&&0!==t.length?(e._last.addClassName("flagrate-grid-cell-menu"),e._menu=new c.ContextMenu({target:e._tr,items:t}),e._last.onclick||(e._last.onclick=e._grid._createLastRowOnClickHandler(e))):e._last.removeClassName("flagrate-grid-cell-menu")}},{key:"_updatePositionOfResizeHandles",value:function(){for(var e=this._opt.fill?-this._body.scrollLeft:0,t=void 0,i=0,n=this._cols.length;i<n;i++)(t=this._cols[i])._resizeHandle&&(t._resizeHandle.style.left=t._th.offsetLeft+t._th.getWidth()+e+"px")}},{key:"_updateLayoutOfCols",value:function(e){for(var t=this,i=!0,n=0,s=void 0,r=0,o=this._cols.length;r<o;r++)if(!(s=this._cols[r]).width){var a="auto",l=void 0===s.minWidth?this._opt.colMinWidth:s.minWidth;e?a=e+"px":l>=s._th.getWidth()?(a=l+"px",++n):i=!1,this._style.updateText(this._style.innerHTML.replace(new RegExp("("+s._id+"{width:)([^}]*)}"),"$1"+a+"}"))}i?this.element.addClassName("flagrate-grid-fixed"):this.element.removeClassName("flagrate-grid-fixed"),setTimeout(function(){var s=t._opt.fill?t._body:t.element;t._style.updateText(t._style.innerHTML.replace(new RegExp("("+t._id+"-col-last:after{right:)([^}]*)}"),"$1"+(s.scrollWidth-s.clientWidth-s.scrollLeft)+"px!important}"));var r=t._lastCol.getWidth();i&&!e&&r&&n&&t._updateLayoutOfCols(Math.floor(r/n))},0)}},{key:"_createOnScrollHandler",value:function(){var e=this;return function(t){!1===e._opt.disableResize&&e._updateLayoutOfCols()}}},{key:"_createBodyOnScrollHandler",value:function(){var e=this;return function(t){e._head.style.right=e._body.offsetWidth-e._body.clientWidth+"px",e._head.scrollLeft=e._body.scrollLeft,!1===e._opt.disableResize&&(e._updateLayoutOfCols(),e._updatePositionOfResizeHandles())}}},{key:"_createColOnClickHandler",value:function(e){var t=this;return function(i){t.sort(e.key,!e.isAsc)}}},{key:"_createRowOnClickHandler",value:function(e){var t=this;return function(i){if(!0===/firefox/i.test(navigator.userAgent)&&(window.event=i),!1!==t.isEnabled())return e.onClick&&e.onClick.call(t,i,e,t),t.onClick&&t.onClick(i,e,t),!1===t._opt.disableSelect&&(!0===e.isSelected?t.deselect(e):t.select(e)),e._checkbox&&e._checkbox.focus(),!1}}},{key:"_createRowOnDblClickHandler",value:function(e){var t=this;return function(i){!0===/firefox/i.test(navigator.userAgent)&&(window.event=i),!1!==t.isEnabled()&&(e.onDblClick&&e.onDblClick.call(t,i,e,t),t.onDblClick&&t.onDblClick(i,e,t))}}},{key:"_createCellOnClickHandler",value:function(e){var t=this;return function(i){!1!==t.isEnabled()&&e.onClick&&e.onClick.call(t,i,e,t)}}},{key:"_createCellOnDblClickHandler",value:function(e){var t=this;return function(i){!1!==t.isEnabled()&&e.onDblClick&&e.onDblClick.call(t,i,e,t)}}},{key:"_createRowOnCheckHandler",value:function(e){var t=this;return function(i){!1!==t.isEnabled()?!1===t._opt.disableSelect&&(!0===e._checkbox.isChecked()?t.select(e):t.deselect(e)):!0===i.targetCheckbox.isChecked()?i.targetCheckbox.uncheck():i.targetCheckbox.check()}}},{key:"_createLastRowOnClickHandler",value:function(e){var t=this;return function(i){!1!==t.isEnabled()&&(i.stopPropagation(),e._menu&&e._menu.open(i))}}},{key:"_createResizeHandleOnMousedownHandler",value:function(e){var t=this;return function(i){i.preventDefault();var n=i.clientX,s=n,r=function(t){t.preventDefault();var i=t.clientX-n;n+=i,e._resizeHandle.style.left=parseInt(e._resizeHandle.style.left.replace("px",""),10)+i+"px"};document.addEventListener("mousemove",r,!0),document.addEventListener("mouseup",function i(n){n.preventDefault(),document.removeEventListener("mousemove",r,!0),document.removeEventListener("mouseup",i,!0);var o=void 0===e.minWidth?t._opt.colMinWidth:e.minWidth,a=n.clientX-s,l=e._th.getWidth()+a;l=e.width=Math.max(l,o),t._style.updateText(t._style.innerHTML.replace(new RegExp("("+e._id+"{width:)([^}]*)}"),"$1"+l+"px}")),t._updateLayoutOfCols(),t._updatePositionOfResizeHandles()},!0)}}},{key:"headless",get:function(){return this.element.hasClassName("flagrate-grid-headless")},set:function(e){e?this.element.addClassName("flagrate-grid-headless"):this.element.removeClassName("flagrate-grid-headless")}},{key:"fill",get:function(){return this.element.hasClassName("flagrate-grid-fill")},set:function(e){e?(this.element.addClassName("flagrate-grid-fill"),this._body.onscroll=this._createBodyOnScrollHandler()):(this.element.removeClassName("flagrate-grid-fill"),this.element.onscroll=this._createOnScrollHandler()),this._requestRender()}},{key:"rows",get:function(){return this._rows},set:function(e){this._rows=e,this._requestRender()}},{key:"sortedByKey",get:function(){return this._sortedByKey}},{key:"sortedByAsc",get:function(){return this._sortedByAsc}},{key:"selectedRows",get:function(){return this.getSelectedRows()},set:function(e){this.select(e)}}]),e}();u.idCounter=0;var h={enumerable:!1},d={_checkbox:h,_grid:h,_last:h,_menu:h,_tr:h,className:h,attribute:h,style:h,postProcess:h,tr:{enumerable:!0,get:function(){return this._tr}},id:{enumerable:!0,get:function(){return this._tr.id||void 0},set:function(e){this._tr.id=e}},menuItems:{enumerable:!0,get:function(){if(this._menu)return this._menu.items},set:function(e){this._grid._updateRowMenu(this,e)}}},f={_td:h,_div:h,className:h,attribute:h,style:h,postProcess:h,td:{enumerable:!0,get:function(){return this._td}},div:{enumerable:!0,get:function(){return this._div}},id:{enumerable:!0,get:function(){return this._td.id||void 0},set:function(e){this._td.id=e}},align:{enumerable:!0,get:function(){return this._td.style.textAlign||void 0},set:function(e){this._td.style.textAlign=e}},text:{enumerable:!1,get:function(){return this._div.innerText},set:function(e){this._div.updateText(e)}},html:{enumerable:!1,get:function(){return this._div.innerHTML},set:function(e){this._div.update(e)}},element:{enumerable:!1,get:function(){return this._div.firstChild},set:function(e){this._div.update(e)}},icon:{enumerable:!0,get:function(){return this._div.style.backgroundImage.replace(/(.*url\()([^)]+)(\).*)/,"$2")||void 0},set:function(e){e?(this._div.addClassName("flagrate-icon"),this._div.style.backgroundImage="url("+e+")"):(this._div.removeClassName("flagrate-icon"),this._div.style.backgroundImage="")}}}},{"./button":9,"./checkbox":11,"./context-menu":14,"./element":15,"./toolbar":34}],18:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Menu=void 0,i.createMenu=function(e){return new a(e)};var n=e("./util"),s=e("./element"),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./button")),o=e("./buttons"),a=i.Menu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.items=e.items||[],this.onSelect=e.onSelect||n.emptyFunction;var t=e.attribute||{};e.id&&(t.id=e.id);var i=new s.Element("div",t);(0,n.extendObject)(i,this),i.addClassName("flagrate flagrate-menu"),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style);for(var r=0,o=e.items.length;r<o;r++)i.push(e.items[r]);return i.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()}),i.addEventListener("mouseup",function(e){e.stopPropagation()}),i};a.prototype={push:function(e){var t=this;if("string"==typeof e)new s.Element("hr").insertTo(this);else{var i=e.onSelect;e.onSelect=function(e,n){i&&i.call(n,e,n),t.onSelect(e,t)};var n=new r.Button(e).insertTo(this);e.key&&(n.dataset._key=e.key)}return this},getButtonByKey:o.Buttons.prototype.getButtonByKey,getButtons:o.Buttons.prototype.getButtons}},{"./button":9,"./buttons":10,"./element":15,"./util":36}],19:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Modal=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createModal=function(e){return new o(e)};var s=e("./element"),r=e("./button"),o=i.Modal=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._opt=t,this._buttons=[],this._close=this.close.bind(this),this.__onKeydownHandler=this._onKeydownHandler.bind(this),t.target||(t.target=document.body),t.sizing||(t.sizing="flex"),void 0===t.disableCloseButton&&(t.disableCloseButton=!1),void 0===t.disableCloseByMask&&(t.disableCloseByMask=!1),void 0===t.disableCloseByEsc&&(t.disableCloseByEsc=!1),t.description&&(this._opt.subtitle=t.description),t.buttons&&(this._buttons=t.buttons),t.onBeforeClose&&(this.onBeforeClose=t.onBeforeClose),t.onClose&&(this.onClose=t.onClose),t.onShow&&(this.onShow=t.onShow),0===this._buttons.length&&(this._buttons=[{label:"OK",color:"@primary",onSelect:this._close,isFocused:!0}]),this._create()}return n(e,[{key:"setId",value:function(e){return this._container.id=e,this}},{key:"setClassName",value:function(e){return this._container.className=e,this}},{key:"setContent",value:function(e){return this._opt.content=e,this._middle.update(e),this}},{key:"setSizing",value:function(e){return this._container.removeClassName("flagrate-sizing-"+this._opt.sizing),this._container.addClassName("flagrate-sizing-"+e),this._opt.sizing=e,this}},{key:"setElement",value:function(e){return this._opt.element=e,this._content.update(e),this}},{key:"setHTML",value:function(e){return this._opt.html=e,this._content.update(e),this}},{key:"setText",value:function(e){return this._opt.text=e,this._content.updateText(e),this}},{key:"setTitle",value:function(e){return this._opt.title=e,this._title.updateText(e),this}},{key:"setSubtitle",value:function(e){return this._opt.subtitle=e,this._subtitle.updateText(e),this}},{key:"visible",value:function(){return this._container.hasClassName("flagrate-modal-visible")}},{key:"open",value:function(){var e=this;return!0===this.visible()?this:(document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),window.getSelection().removeAllRanges(),this._closingTimer&&clearTimeout(this._closingTimer),s.Element.insert(this._opt.target,this._container),setTimeout(function(){return e._container.addClassName("flagrate-modal-visible")},0),this.onShow&&this.onShow(this),this._positioning(),this._buttons[0]&&this._buttons[0]._button.focus(),window.addEventListener("keydown",this.__onKeydownHandler,!0),this)}},{key:"show",value:function(){return this.open()}},{key:"render",value:function(){return this.open()}},{key:"close",value:function(e){var t=this;return!1===this.visible()?this:(this._container.removeClassName("flagrate-modal-visible"),e&&(e.stopPropagation(),e.preventDefault()),this.onBeforeClose&&!1===this.onBeforeClose(this,e)?this:(clearTimeout(this._positioningTimer),this._closingTimer=setTimeout(function(){return t._container.remove()},1e3),window.removeEventListener("keydown",this.__onKeydownHandler,!0),this.onClose&&this.onClose(this,e),this))}},{key:"getButtonByKey",value:function(e){for(var t=null,i=this._buttons,n=0;n<i.length;n++)if(i[n].key&&i[n].key===e){t=i[n]._button;break}return t}},{key:"getButtons",value:function(){return this._buttons.map(function(e){return e._button})}},{key:"setButtons",value:function(e){return this._buttons=e,this._createButtons(),this}},{key:"_create",value:function(){this._createBase(),this._createModal(),this._createButtons()}},{key:"_createBase",value:function(){this._container=new s.Element("div",{id:this._opt.id,class:"flagrate flagrate-modal flagrate-sizing-"+this._opt.sizing}),this._opt.className&&this._container.addClassName(this._opt.className),this._opt.target!==document.body&&(this._container.style.position="absolute"),this._obi=(new s.Element).insertTo(this._container),!1===this._opt.disableCloseByMask&&this._container.addEventListener("click",this._close)}},{key:"_createModal",value:function(){this._modal=(new s.Element).insertTo(this._obi),this._modal.addEventListener("click",function(e){return e.stopPropagation()}),this._closeButton=new r.Button({label:"",onSelect:this._close}),!1===this._opt.disableCloseButton&&this._closeButton.insertTo(this._modal),this._header=new s.Element("hgroup").insertTo(this._modal),this._title=new s.Element("h1").insertText(this._opt.title||"").insertTo(this._header),this._subtitle=new s.Element("small").insertText(this._opt.subtitle||"").insertTo(this._header),this._middle=(new s.Element).insertTo(this._modal),this._opt.content?this._middle.insert(this._opt.content):(this._content=(new s.Element).insertTo(this._middle),this._opt.element?this._content.insert(this._opt.element):this._opt.html?this._content.insert(this._opt.html):this._opt.text&&this._content.insertText(this._opt.text)),this._footer=new s.Element("footer").insertTo(this._modal)}},{key:"_createButtons",value:function(){var e=this;!0===this._footer.hasChildNodes()&&this._footer.update(),this._buttons.forEach(function(t){t._button=new r.Button({className:t.className,label:t.label,icon:t.icon,color:t.color,isFocused:t.isFocused||!1,isDisabled:t.isDisabled,onSelect:function(i){t.onSelect?t.onSelect.call(i.targetButton,i,e):t.onClick&&(console.warn("ModalButton#onClick is deprecated. Use ModalButton#onSelect instead."),t.onClick(i,e))}}),t._button.button=t,t.button=t._button,t.disable=t._button.disable.bind(t._button),t.enable=t._button.enable.bind(t._button),t.setColor=t._button.setColor.bind(t._button),e._footer.insert(t._button)})}},{key:"_positioning",value:function(){var e=this,t=-1,i=-1,n=-1,s=-1;this._positioningTimer=setTimeout(function r(){t===e._container.getWidth()&&i===e._container.getHeight()&&n===e._modal.getWidth()&&s===e._modal.getHeight()||(t=e._container.getWidth(),i=e._container.getHeight(),n=e._modal.getWidth(),s=e._modal.getHeight(),"flex"===e._opt.sizing&&(t-20<=n?(e._modal.style.left="0",e._middle.style.width=t+"px",e._middle.style.overflowX="auto"):(e._modal.style.left=Math.floor(t/2-n/2)+"px",e._middle.style.width="",e._middle.style.overflowX="visible"),i-20<=s?(e._obi.style.top="10px",e._obi.style.bottom="10px",e._obi.style.height="",e._middle.style.height=i-e._header.getHeight()-e._footer.getHeight()-20+"px",e._middle.style.overflowY="auto"):(e._obi.style.top=i/2-s/2+"px",e._obi.style.bottom="",e._obi.style.height=s+"px",e._middle.style.height="",e._middle.style.overflowY="visible")),"full"===e._opt.sizing&&(e._modal.style.right="10px",e._modal.style.left="10px",e._middle.style.overflowX="auto",e._obi.style.top="10px",e._obi.style.bottom="10px",e._obi.style.height="",e._middle.style.height=i-e._header.getHeight()-e._footer.getHeight()-20+"px",e._middle.style.overflowY="auto")),e._positioningTimer=setTimeout(r,30)},0)}},{key:"_onKeydownHandler",value:function(e){var t=document.activeElement&&document.activeElement.tagName;if(!1!==this.visible()&&("BODY"===t||"DIV"===t||"BUTTON"===t)&&""===window.getSelection().toString()){var i=!1;9===e.keyCode&&"BUTTON"!==t&&(i=!0,this._closeButton?this._closeButton.focus():this._buttons[0]&&this._buttons[0]._button.focus()),13===e.keyCode&&this._buttons[0]&&"BUTTON"!==t&&(i=!0,this._buttons[0]._button.click()),27===e.keyCode&&!1===this._opt.disableCloseByEsc&&(i=!0,this.close()),!0===i&&(e.stopPropagation(),e.preventDefault())}}},{key:"buttons",get:function(){return this.getButtons()}},{key:"id",get:function(){return this._container.id},set:function(e){this._container.id=e}},{key:"className",get:function(){return this._container.className},set:function(e){this._container.className=e}},{key:"content",get:function(){return this._content},set:function(e){this.setContent(e)}},{key:"sizing",get:function(){return this._opt.sizing},set:function(e){this.setSizing(e)}},{key:"element",get:function(){return this._opt.element},set:function(e){this.setElement(e)}},{key:"html",get:function(){return this._opt.html},set:function(e){this.setHTML(e)}},{key:"text",get:function(){return this._opt.text},set:function(e){this.setText(e)}},{key:"title",get:function(){return this._opt.title},set:function(e){this.setTitle(e)}},{key:"subtitle",get:function(){return this._opt.subtitle},set:function(e){this.setSubtitle(e)}}]),e}()},{"./button":9,"./element":15}],20:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Notify=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createNotify=function(e){return new r(e)};var s=e("./element"),r=i.Notify=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=document.body,this.disableDesktopNotify=!1,this.disableFocusDetection=!1,this.hAlign="right",this.vAlign="bottom",this.hMargin=10,this.vMargin=10,this.spacing=10,this.timeout=5,this.title="Notify",this._notifies=[],t.target&&(this.target=t.target),t.className&&(this.className=t.className),t.disableDesktopNotify&&(this.disableDesktopNotify=t.disableDesktopNotify),t.disableFocusDetection&&(this.disableFocusDetection=t.disableFocusDetection),t.hAlign&&(this.hAlign=t.hAlign),t.vAlign&&(this.vAlign=t.vAlign),t.hMargin&&(this.hMargin=t.hMargin),t.vMargin&&(this.vMargin=t.vMargin),t.spacing&&(this.spacing=t.spacing),t.timeout&&(this.timeout=t.timeout),t.title&&(this.title=t.title),t.icon&&(this.icon=t.icon),this._init()}return n(e,[{key:"create",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=void 0;if(i="string"==typeof t?{text:t}:t,!1===this.disableDesktopNotify){var n=!!document.hasFocus&&document.hasFocus();if(!1===this.disableFocusDetection&&!1===n&&!0===this._createDesktopNotify(i))return this}var r=i.title||this.title,o=i.message||i.body||i.content||i.text||null,a=i.onClick,l=i.onClose,c=void 0!==i.timeout?i.timeout:this.timeout,u=i.icon||this.icon,h=!0,d=void 0,f=this.hMargin,g=this.vMargin,p=new s.Element("div",{class:this.className});p.addClassName("flagrate flagrate-notify"),new s.Element("div",{class:"title"}).insertText(r).insertTo(p),new s.Element("div",{class:"text"}).insertText(o).insertTo(p);var m=new s.Element("div",{class:"close"}).update("&#xd7;").insertTo(p);u&&(p.addClassName("flagrate-notify-icon"),new s.Element("div",{class:"icon"}).setStyle({backgroundImage:"url("+u+")"}).insertTo(p));var v=function(){!1!==h&&(h=!1,p.style.opacity="0",l&&l.call(e),setTimeout(function(){e.target.removeChild(p),e._notifies.splice(e._notifies.indexOf(p),1),e._positioner()},300))};if(m.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),h&&v()},!1),p.style.display="none",p.style.position="fixed",p.style[this.hAlign]=f+"px",p.style[this.vAlign]=g+"px",a?(p.style.cursor="pointer",p.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),a.call(e),v()})):p.addEventListener("click",v),this.target.appendChild(p),p.style.display="block",setTimeout(function(){p.style.opacity="1"},10),0!==c){var _=function(){h&&v()};d=setTimeout(_,1e3*c),p.addEventListener("mouseover",function(){clearTimeout(d),d=setTimeout(_,1e3*c)})}return this._notifies.push(p),this._positioner(),this}},{key:"_init",value:function(){!1===this.disableDesktopNotify&&(window.Notification&&window.Notification.permission?"file:"!==location.protocol&&"default"===window.Notification.permission&&this.create({text:"Click here to Activate the Desktop Notifications...",onClick:function(){window.Notification.requestPermission()}}):this.disableDesktopNotify=!0)}},{key:"_createDesktopNotify",value:function(e){var t=this,i=e.title||this.title,n=e.message||e.body||e.content||e.text||null,s=e.onClick,r=e.onClose,o=void 0!==e.timeout?e.timeout:this.timeout,a=e.icon||this.icon,l=!0,c=null;return"granted"===window.Notification.permission&&(c=new window.Notification(i,{icon:a,body:n}),0!==o&&setTimeout(function(){l&&c.close()},1e3*o),c.addEventListener("click",function(){s&&s.call(t),c.close()}),c.onclose=function(){l=!1,r&&r.call(t)},c.show&&c.show(),!0)}},{key:"_positioner",value:function(){for(var e=this.target===document.body?window.innerHeight||document.body.clientHeight:this.target.offsetHeight,t=0,i=0,n=0,s=this._notifies.length;n<s;n++){var r=this._notifies[n],o=this.vMargin+t,a=this.hMargin+i;r.style[this.hAlign]=o.toString(10)+"px",r.style[this.vAlign]=a.toString(10)+"px",(i+=this.spacing+r.offsetHeight)+r.offsetHeight+this.vMargin+this.spacing>=e&&(i=0,t+=this.spacing+r.offsetWidth)}}}]),e}()},{"./element":15}],21:[function(e,t,i){"use strict";function n(e,t){var i=r.Element.cumulativeOffset(e),n=r.Element.cumulativeScrollOffset(e),s=r.Element.getWidth(e),o=r.Element.getHeight(e),a=t.getWidth(),l=t.getHeight(),c=i.left-n.left+Math.round(s/2-a/2),u=i.top-n.top+o;u+l>window.innerHeight?(u=window.innerHeight-u+o,t.removeClassName("flagrate-popover-tail-top"),t.addClassName("flagrate-popover-tail-bottom"),t.style.top="",t.style.bottom=u+"px"):(t.removeClassName("flagrate-popover-tail-bottom"),t.addClassName("flagrate-popover-tail-top"),t.style.top=u+"px",t.style.bottom=""),t.style.left=c+"px"}Object.defineProperty(i,"__esModule",{value:!0}),i.Popover=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createPopover=function(e){return new o(e)};var r=e("./element"),o=i.Popover=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._isShowing=!1,this._openHandler=this.open.bind(this),this._closeHandler=this.close.bind(this),t.target&&(t.target.isFlagrated||(t.target=r.Element.extend(t.target)),this._target=t.target),t.text&&(this._text=t.text),t.html&&(this._html=t.html),t.element&&(this._element=t.element),t.className&&(this._className=t.className),this._target&&this._target.addEventListener("mouseover",this._openHandler)}return s(e,[{key:"open",value:function(e){var t=this;!0===this._isShowing&&this.close();var i=this._target||document.documentElement;e instanceof Event?(!0===r.Element.isElement(e.target)&&(i=e.target),document.body.addEventListener("click",this._closeHandler),document.body.addEventListener("mouseout",this._closeHandler),document.body.addEventListener("mouseup",this._closeHandler),window.addEventListener("scroll",this._closeHandler)):!0===r.Element.isElement(e)&&(i=e);var s=this._create();return this._positioningTimer=setInterval(function(){!0===r.Element.exists(i)?n(i,s):t.close()},10),this._div.on("click",function(e){return e.stopPropagation()}),this._div.on("mouseup",function(e){return e.stopPropagation()}),this._div.on("mousewheel",function(e){e.stopPropagation(),e.preventDefault()}),n(i,s),this}},{key:"close",value:function(){if(void 0===this._div)return this;clearInterval(this._positioningTimer),document.body.removeEventListener("click",this._closeHandler),document.body.removeEventListener("mouseup",this._closeHandler),document.body.removeEventListener("mouseout",this._closeHandler),window.removeEventListener("scroll",this._closeHandler),this._isShowing=!1;var e=this._div;return e.removeClassName("flagrate-popover-visible"),setTimeout(function(){e&&e.remove&&e.remove()},1e3),delete this._div,this}},{key:"visible",value:function(){return this._isShowing&&!!this._div.hasClassName("flagrate-popover-visible")}},{key:"remove",value:function(){this._div&&this.close(),this._target&&this._target.removeEventListener("mouseover",this._openHandler)}},{key:"setTarget",value:function(e){return this._target===e?this:(e.isFlagrated||(e=r.Element.extend(e)),this._target=e,!0===this._isShowing&&this.open(),this)}},{key:"setText",value:function(e){return this._text===e?this:(this._text=e,!0===this._isShowing&&this._div.updateText(e),this)}},{key:"setHTML",value:function(e){return this._html===e?this:(this._html=e,!0===this._isShowing&&this._div.update(e),this)}},{key:"setElement",value:function(e){return this._element===e?this:(this._element=e,!0===this._isShowing&&this._div.update(e),this)}},{key:"setClassName",value:function(e){return this._className===e?this:(!0===this._isShowing&&this._div.removeClassName(this._className).addClassName(e),this._className=e,this)}},{key:"_create",value:function(){this._isShowing=!0;var e=this._div=new r.Element("div",{class:"flagrate flagrate-popover"});return this._className&&e.addClassName(this._className),this._text&&e.updateText(this._text),this._html&&e.update(this._html),this._element&&e.update(this._element),e.insertTo(document.body),setTimeout(function(){return e.addClassName("flagrate-popover-visible")},0),e}},{key:"target",get:function(){return this._target},set:function(e){this.setTarget(e)}},{key:"text",get:function(){return this._text},set:function(e){this.setText(e)}},{key:"html",get:function(){return this._html},set:function(e){this.setHTML(e)}},{key:"element",get:function(){return this._element},set:function(e){this.setElement(e)}},{key:"className",get:function(){return this._className},set:function(e){this.setClassName(e)}},{key:"isShowing",get:function(){return this._isShowing},set:function(e){!0===e?this.open():this.close()}}]),e}()},{"./element":15}],22:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Progress=void 0,i.createProgress=function(e){return new r(e)};var n=e("./util"),s=e("./element"),r=i.Progress=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.attribute||{};t.id=e.id||null,t.class=e.className||null;var i=new s.Element("div",t);return(0,n.extendObject)(i,this),i._value=e.value||0,i._max=e.max||100,i.addClassName("flagrate flagrate-progress"),i._bar=(new s.Element).insertTo(i),i._updateProgress(),i};r.prototype={getValue:function(){return this._value},setValue:function(e){return"number"!=typeof e?this:(this._value=Math.max(0,Math.min(this._max,e)),this.fire("change",{targetProgress:this}),this._updateProgress(),this)},getMax:function(){return this._max},setMax:function(e){return"number"!=typeof e?this:(this._max=e,this.setValue(this._value),this._updateProgress(),this)},_updateProgress:function(){var e=Math.max(0,Math.min(100,this._value/this._max*100));this._bar.setStyle({width:e+"%"})}}},{"./element":15,"./util":36}],23:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Pulldown=void 0,i.createPulldown=function(e){return new a(e)};var n=e("./util"),s=e("./element"),r=e("./button"),o=e("./menu"),a=i.Pulldown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.label=e.label||"",this.items=e.items||[],this.onOpen=e.onOpen||n.emptyFunction,this.onClose=e.onClose||n.emptyFunction;var t=e.attribute||{};e.id&&(t.id=e.id);var i=new r.Button({attribute:t,label:e.label,icon:e.icon,onSelect:e.onSelect});return(0,n.extendObject)(i,this),i.addEventListener("select",i.open.bind(i)),i.addClassName("flagrate-pulldown"),e.className&&i.addClassName(e.className),new s.Element("span",{class:"flagrate-pulldown-triangle"}).insertTo(i),e.style&&i.setStyle(e.style),e.color&&i.setColor(e.color),e.isDisabled&&i.disable(),i};a.prototype={open:function(e){var t=this;{if(!0!==t._open&&!t._menu){t._open=!0,t._menu=new s.Element("div",{class:"flagrate-pulldown-menu"}).insert(new o.Menu({items:t.items,onSelect:function(e){t.onSelect&&t.onSelect(e,t),t.fire("select",{targetPulldown:t})}})),t._menu.style.top=t.offsetTop+t.getHeight()+"px",t._menu.style.left=t.offsetLeft+"px",t.insert({after:t._menu});var i=t._menu.getHeight(),n=parseInt(t._menu.getStyle("margin-top").replace("px",""),10),r=t.cumulativeOffset().top,a=-window.pageYOffset+r,l=window.pageYOffset+window.innerHeight-r-t.getHeight();i+n>l&&(a>l?(a<i+n&&(i=a-n-n,t._menu.style.maxHeight=i+"px"),t._menu.style.top=t.offsetTop-i-2*n+"px"):(i=l-n-n,t._menu.style.maxHeight=i+"px"));var c=function e(i){document.body.removeEventListener("click",e),t.parentNode&&t.parentNode.removeEventListener("click",e),t.removeEventListener("select",e),t.close(i)};return setTimeout(function(){document.body.addEventListener("click",c),t.parentNode&&t.parentNode.addEventListener("click",c),t.addEventListener("select",c)},0),t.onOpen.call(t,e,t),t.fire("open",{targetPulldown:t}),this}t.close()}},close:function(e){var t=this;if(!1!==t._open&&t._menu)return t._open=!1,t._menu.style.opacity="0",setTimeout(function(){t._menu&&(t._menu.remove(),delete t._menu,t.onClose(e,t),t.fire("close",{targetPulldown:t}))},250),this}}},{"./button":9,"./element":15,"./menu":18,"./util":36}],24:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Radio=void 0,i.createRadio=function(e){return new o(e)};var n=e("./util"),s=e("./element"),r=0,o=i.Radio=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="flagrate-radio-"+(++r).toString(10),i=e.attribute||{};i.id=e.id||null,i.class=e.className||null;var o=new s.Element("label",i);return o.writeAttribute("for",t),(0,n.extendObject)(o,this),e.label?o.insertText(e.label):e.labelHTML&&o.insert(e.labelHTML),o.addClassName("flagrate flagrate-radio"),e.icon&&(o.addClassName("flagrate-icon"),o.setStyle({backgroundImage:"url("+e.icon+")"})),o.onChange=e.onChange||null,o.onCheck=e.onCheck||null,o.onUncheck=e.onUncheck||null,o._input=new s.Element("input",{id:t,type:"radio",name:e.name}),o.insert({top:new s.Element}),o.insert({top:o._input}),o._input.addEventListener("change",function(e){e.stopPropagation();var t=e;t.targetRadio=o,!0===o.isChecked()?(o.onCheck&&o.onCheck(t,o),o.fire("check",{targetRadio:o})):(o.onUncheck&&o.onUncheck(t,o),o.fire("uncheck",{targetRadio:o})),o.onChange&&o.onChange(t,o),o.fire("change",{targetRadio:o})}),!0===e.isChecked&&o.check(),!0===e.isFocused&&o.focus(),!0===e.isDisabled&&o.disable(),o};o.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this._input.writeAttribute("disabled",!0),this},enable:function(){return this.removeClassName("flagrate-disabled"),this._input.writeAttribute("disabled",!1),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},isChecked:function(){return!!this._input.checked},check:function(){return this._input.checked=!0,this},uncheck:function(){return this._input.checked=!1,this}}},{"./element":15,"./util":36}],25:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Radios=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.createRadios=function(e){return new l(e)};var s=e("./util"),r=e("./element"),o=e("./radio"),a=0,l=i.Radios=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="flagrate-radios-"+(++a).toString(10),i=e.attribute||{};e.id&&(i.id=e.id);var l=new r.Element("div",i);return(0,s.extendObject)(l,this),l.addClassName("flagrate flagrate-radios"),e.className&&l.addClassName(e.className),e.style&&l.setStyle(e.style),l.onChange=e.onChange,l.selectedIndex=e.selectedIndex||-1,l._items=[],(e.items||[]).forEach(function(e,i){var r={};"object"===(void 0===e?"undefined":n(e))?(0,s.extendObject)(r,e):(r.label="string"==typeof e?e:e.toString(),r.value=e),r.name=t,r._radio=new o.Radio(r).insertTo(l),r._radio.addEventListener("change",function(e){l.onChange&&l.onChange(e,l)}),r._radio.addEventListener("check",function(e){l.selectedIndex=i}),l._items.push(r)}),e.isDisabled&&l.disable(),l.selectedIndex>-1&&l._items[l.selectedIndex]._radio.check(),l};l.prototype={select:function(e){return void 0!==this._items[e]&&(this.selectedIndex=e,this._items[e]._radio.check()),this},getValue:function(){return-1===this.selectedIndex?void 0:this._items[this.selectedIndex].value},setValue:function(e){for(var t=0,i=this._items.length;t<i;t++)if(this._items[t].value===e){this.select(t);break}return this},enable:function(){for(var e=0,t=this._items.length;e<t;e++)this._items[e]._radio.enable();return this.removeClassName("flagrate-disabled"),this},disable:function(){for(var e=0,t=this._items.length;e<t;e++)this._items[e]._radio.disable();return this.addClassName("flagrate-disabled"),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")}}},{"./element":15,"./radio":24,"./util":36}],26:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SearchBox=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.createSearchBox=function(e){return new c(e)};var s=e("./util"),r=e("./element"),o=e("./button"),a=e("./text-input"),l=e("./menu"),c=i.SearchBox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.suggester=e.suggester||null,this.onSearch=e.onSearch||s.emptyFunction;var t=e.attribute||{};t.id=e.id||null,t.class=e.className||null;var i=new r.Element("div",t);return(0,s.extendObject)(i,this),i.addClassName("flagrate flagrate-search-box"),i._input=new a.TextInput({className:"search-input",value:e.value,placeholder:e.placeholder,icon:e.icon}).insertTo(i),i._button=new o.Button({className:"search-button",onSelect:i.search.bind(i)}).insertTo(i),i._suggest=new r.Element("div",{class:"search-suggest"}).hide().insertTo(i),i._input.on("keydown",i._onKeydownHandler.bind(i)),i._input.on("keyup",i._onKeyupHandler.bind(i)),i._input.on("focus",i._onFocusHandler.bind(i)),i._input.on("blur",i._onBlurHandler.bind(i)),i._suggest.on("mousedown",function(e){return e.preventDefault()}),e.style&&i.setStyle(e.style),e.isDisabled&&i.disable(),i};c.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this._input.disable(),this._button.disable(),this._suggest.hide(),this},enable:function(){return this.removeClassName("flagrate-disabled"),this._input.enable(),this._button.enable(),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},getValue:function(){return this._input.getValue()},setValue:function(e){return this._input.setValue(e),this},search:function(){var e=this.getValue();return this.onSearch(e,this),this.fire("search",e),this._input.blur(),this},suggest:function(){if(!this.suggester)return this;this._suggest.hide();var e=this.getValue(),t=this.suggester(e,this._suggested.bind(this));return void 0!==t&&this._suggested(t),this},focus:function(){this._input.focus()},blur:function(){this._input.blur()},_suggested:function(e){var t=this;if(e)if(0!==e.length){var i=[];if(e.forEach(function(e){"string"==typeof e&&""!==e.trim()?i.push({label:e.trim(),onSelect:function(e,t){return function(){e._input.setValue(t),e._input.focus()}}(t,e.trim())}):"object"===(void 0===e?"undefined":n(e))&&i.push({label:e.label,icon:e.icon,onSelect:function(e,t){return function(){t.call(e),e._input.blur()}}(t,e.onSelect)})}),0!==i.length){var s=this._menu=new l.Menu({items:i,onSelect:function(){t._suggest.hide()}});r.Element.addClassName(s.firstChild,"flagrate-search-suggest-selected"),this._suggest.update(s).show();var o=this._suggest.getHeight(),a=parseInt(this._suggest.getStyle("margin-top").replace("px",""),10),c=this.cumulativeOffset().top,u=-window.pageYOffset+c,h=window.pageYOffset+window.innerHeight-c-this.getHeight();o+a>h?u>h?(u<o+a&&(o=u-a-a,this._suggest.style.maxHeight=o+"px"),this._suggest.addClassName("flagrate-search-suggest-upper")):(o=h-a-a,this._suggest.style.maxHeight=o+"px",this._suggest.removeClassName("flagrate-search-suggest-upper")):this._suggest.removeClassName("flagrate-search-suggest-upper"),this._suggest.scrollTop=0}else this._suggest.hide()}else this._suggest.hide()},_onKeydownHandler:function(e){if(27===e.keyCode)this._input.select(),this._suggest.hide();else if(!0===this._suggest.visible()){if(13===e.keyCode){return void this._menu.getElementsByClassName("flagrate-search-suggest-selected")[0].click()}if(38!==e.keyCode&&40!==e.keyCode)return;e.preventDefault();for(var t=this._menu.getElementsByTagName("button"),i=0,n=t.length;i<n;i++)if(!0===t[i].hasClassName("flagrate-search-suggest-selected")){(38===e.keyCode&&0!==i||40===e.keyCode&&i+1!==n)&&t[i].removeClassName("flagrate-search-suggest-selected");var s=-1;38===e.keyCode&&0!==i?(t[i-1].addClassName("flagrate-search-suggest-selected"),s=t[i-1].offsetHeight+t[i-1].offsetTop):40===e.keyCode&&i+1!==n&&(t[i+1].addClassName("flagrate-search-suggest-selected"),s=t[i+1].offsetHeight+t[i+1].offsetTop),-1!==s&&(this._suggest.scrollTop=s+4-this._suggest.getHeight());break}}else 13===e.keyCode&&setTimeout(this.search.bind(this),100)},_onKeyupHandler:function(e){this._lastValue!==this.getValue()&&(this._lastValue=this.getValue(),this.suggest())},_onFocusHandler:function(e){setTimeout(this.suggest.bind(this),100)},_onBlurHandler:function(e){var t=this;setTimeout(function(){document.activeElement!==t._suggest&&!0===t._suggest.visible()&&t._suggest.hide()},100)}}},{"./button":9,"./element":15,"./menu":18,"./text-input":32,"./util":36}],27:[function(e,t,i){"use strict";function n(){function e(e){return function(){return n.select(e)}}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.items=t.items||[],this.listView=t.listView||!1,this.multiple=t.multiple||!1,this.max=t.max||-1,this.multiple?this.selectedIndexes=t.selectedIndexes||[]:this.selectedIndex=void 0===t.selectedIndex?-1:t.selectedIndex;var i=t.attribute||{};t.id&&(i.id=t.id),this.isPulldown=!this.listView&&!this.multiple;for(var n=new o.Element("div",i),c=0,u=this.items.length;c<u;c++)"object"!==s(this.items[c])&&(this.items[c]={label:"string"==typeof this.items[c]?this.items[c]:this.items[c].toString(10),value:this.items[c]});return this.isPulldown?n._pulldown=new a.Pulldown({label:"-",items:[{label:"-",onSelect:e(-1)}].concat(this.items.map(function(t,i){return{label:t.label,labelHTML:t.labelHTML,icon:t.icon,onSelect:e(i)}}))}).insertTo(n):n._grid=new l.Grid({headless:!0,multiSelect:this.multiple,cols:[{key:"label"}],rows:this.items.map(function(t,i){return{cell:{label:{text:t.label,html:t.labelHTML,icon:t.icon}},onSelect:e(i),onDeselect:function(e){return function(){return n.deselect(e)}}(i)}})}).insertTo(n),(0,r.extendObject)(n,this),n.addClassName("flagrate flagrate-select"),n.isPulldown||n.addClassName("flagrate-select-list-view"),t.className&&n.addClassName(t.className),t.style&&n.setStyle(t.style),t.isDisabled&&n.disable(),n.multiple?n.selectedIndexes.forEach(function(e){n.select(e)}):n.selectedIndex>-1&&n.select(n.selectedIndex),n}Object.defineProperty(i,"__esModule",{value:!0}),i.Select=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.createSelect=function(e){return new c(e)};var r=e("./util"),o=e("./element"),a=e("./pulldown"),l=e("./grid"),c=i.Select=n;c.prototype={select:function(e){if(this.items.length<=e)return this;if(this.multiple){if(this.max>-1&&this.selectedIndexes.length>=this.max)return!0===this._grid.rows[e].isSelected&&this._grid.deselect(e),this;-1===this.selectedIndexes.indexOf(e)&&this.selectedIndexes.push(e)}else this.selectedIndex=e;return this.isPulldown?(-1===e?(this._pulldown.setLabel("-"),this._pulldown.setIcon(null)):(void 0!==this.items[e].label?this._pulldown.setLabel(this.items[e].label):void 0!==this.items[e].labelHTML&&this._pulldown.setLabelHTML(this.items[e].labelHTML),this._pulldown.setIcon(this.items[e].icon)),this.fire("change")):this._grid.rows[e].isSelected||this._grid.select(e),this},deselect:function(e){if(this.items.length<=e)return this;if(this.multiple){-1!==this.selectedIndexes.indexOf(e)&&this.selectedIndexes.splice(this.selectedIndexes.indexOf(e),1)}else this.selectedIndex=-1;if(this.isPulldown)this._pulldown.setLabel("-"),this._pulldown.setIcon(null),this.fire("change");else if(this.multiple)!0===this._grid.rows[e].isSelected&&this._grid.deselect(e);else for(var t=0,i=this.items.length;t<i;t++)!0===this._grid.rows[t].isSelected&&this._grid.deselect(t);return this},selectAll:function(){if(this.multiple){this._grid.selectAll(),this.selectedIndexes=[];for(var e=0,t=this.items.length;e<t;e++)this.selectedIndexes.push(e)}return this},deselectAll:function(){return this.multiple?(this._grid.deselectAll(),this.selectedIndexes=[]):this.deselect(),this},disable:function(){return this.addClassName("flagrate-disabled"),this.isPulldown?this._pulldown.disable():this._grid.disable(),this},enable:function(){return this.removeClassName("flagrate-disabled"),this.isPulldown?this._pulldown.enable():this._grid.enable(),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},getValue:function(){return this.selectedIndex>-1?this.items[this.selectedIndex].value:void 0},getValues:function(){for(var e=[],t=0,i=this.selectedIndexes.length;t<i;t++)e.push(this.items[this.selectedIndexes[t]].value);return e}}},{"./element":15,"./grid":17,"./pulldown":23,"./util":36}],28:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,i.createSlider=function(e){return new r(e)};var n=e("./util"),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./progress")),r=i.Slider=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new s.Progress(e);return(0,n.extendObject)(t,this),t.addClassName("flagrate-slider"),-1===t.tabIndex&&(t.tabIndex=0),void 0!==window.ontouchstart&&t.addEventListener("touchstart",t._onTouchStartHandler.bind(t)),navigator.pointerEnabled?t.addEventListener("pointerdown",t._onPointerDownHandler.bind(t)):navigator.msPointerEnabled?t.addEventListener("MSPointerDown",t._onPointerDownHandler.bind(t)):t.addEventListener("mousedown",t._onPointerDownHandler.bind(t)),e.isDisabled&&t.disable(),t};r.prototype={disable:function(){return this.dataset.flagrateTabIndex=this.tabIndex.toString(10),this.removeAttribute("tabindex"),this.addClassName("flagrate-disabled")},enable:function(){var e=parseInt(this.dataset.flagrateTabIndex);return-1!==e&&(this.tabIndex=e),this.removeClassName("flagrate-disabled")},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},_onTouchStartHandler:function(e){this.isEnabled()&&(e.preventDefault(),this._slide(e.touches[0].pageX-this.cumulativeOffset().left,e.touches[0].clientX,"touch"))},_onPointerDownHandler:function(e){this.isEnabled()&&(e.preventDefault(),this._slide(e.offsetX||e.layerX,e.clientX,"pointer"))},_slide:function(e,t,i){var n=this,s=n.getWidth()/n.getMax(),r=function(i){i.preventDefault(),i.touches&&i.touches[0]?(e=e+i.touches[0].clientX-t,t=i.touches[0].clientX):(e=e+i.clientX-t,t=i.clientX),n.setValue(Math.round(e/s)),n.fire("slide",{targetSlider:n})},o=function o(a){a.preventDefault(),"pointer"===i?navigator.pointerEnabled?(document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",o)):navigator.msPointerEnabled?(document.removeEventListener("MSPointerUp",o),document.removeEventListener("MSPointerMove",r)):(document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",o)):"touch"===i&&(document.removeEventListener("touchmove",r),document.removeEventListener("touchend",o),document.removeEventListener("touchcancel",o)),a.clientX?(e=e+a.clientX-t,n.setValue(Math.round(e/s)),n.fire("slide",{targetSlider:n})):a.touches&&a.touches[0]&&(e=e+a.touches[0].clientX-t,n.setValue(Math.round(e/s)),n.fire("slide",{targetSlider:n}))};"pointer"===i?navigator.pointerEnabled?(document.addEventListener("pointermove",r),document.addEventListener("pointerup",o)):navigator.msPointerEnabled?(document.addEventListener("MSPointerMove",r),document.addEventListener("MSPointerUp",o)):(document.addEventListener("mousemove",r),document.addEventListener("mouseup",o)):"touch"===i&&(document.addEventListener("touchmove",r),document.addEventListener("touchend",o),document.addEventListener("touchcancel",o)),n.setValue(Math.round(e/s)),n.fire("slide",{targetSlider:n})}}},{"./progress":22,"./util":36}],29:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Switch=void 0,i.createSwitch=function(e){return new r(e)};var n=e("./util"),s=e("./button"),r=i.Switch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new s.Button({id:e.id,className:e.className,attribute:e.attribute,style:e.style,isFocused:e.isFocused,isDisabled:e.isDisabled});return(0,n.extendObject)(t,this),t.addEventListener("select",t.toggleSwitch.bind(t)),t.addClassName("flagrate-switch"),t.dataset?t.dataset.flagrateSwitchStatus=e.isOn?"on":"off":t.writeAttribute("data-flagrate-switch-status",e.isOn?"on":"off"),t};r.prototype={isOn:function(){return this.dataset?"on"===this.dataset.flagrateSwitchStatus:"on"===this.readAttribute("data-flagrate-switch-status")},switchOn:function(){return this.dataset?this.dataset.flagrateSwitchStatus="on":this.writeAttribute("data-flagrate-switch-status","on"),this.fire("on",{targetSwitch:this}).fire("change",{targetSwitch:this})},switchOff:function(){return this.dataset?this.dataset.flagrateSwitchStatus="off":this.writeAttribute("data-flagrate-switch-status","off"),this.fire("off",{targetSwitch:this}).fire("change",{targetSwitch:this})},toggleSwitch:function(){return this.isOn()?this.switchOff():this.switchOn()}}},{"./button":9,"./util":36}],30:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Tab=void 0,i.createTab=function(e){return new o(e)};var n=e("./util"),s=e("./element"),r=e("./button"),o=i.Tab=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.attribute||{};t.id=e.id,t.class="flagrate flagrate-tab",e.fill&&(t.class+=" flagrate-tab-fill");var i=new s.Element("div",t);return(0,n.extendObject)(i,this),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style),i._tabs=e.tabs||[],i._bodyless=e.bodyless||!1,i._selectedIndex=e.selectedIndex||0,i.onSelect=e.onSelect||null,Object.defineProperties(i,{tabs:{enumerable:!0,get:function(){return i._tabs},set:function(e){i._tabs=e,i._render()}},bodyless:{enumerable:!0,get:function(){return i._bodyless},set:function(e){i._bodyless=e,i.update()._create()._render()}},selectedIndex:{enumerable:!0,get:function(){return i._selectedIndex},set:function(e){i.select(e)}}}),i._create()._render(),i.tabs.length>0&&i.select(i.selectedIndex),i};o.prototype={select:function(e){var t=this,i="number"==typeof e?e:t.indexOf(e);if(i<0||i>=t._tabs.length)return t;0<=t._selectedIndex&&t._selectedIndex<t._tabs.length&&t._tabs[t._selectedIndex]._button&&t._tabs[t._selectedIndex]._button.removeClassName("flagrate-tab-selected"),t._selectedIndex=i;var n=t._tabs[i];if(!n||!n._button)return t;n._button.addClassName("flagrate-tab-selected"),n.text&&t._body.updateText(n.text),n.html&&t._body.update(n.html),n.element&&t._body.update(n.element);var s=window.event||{};return s.targetTab=t,s.targetTabItem=n,n.onSelect&&n.onSelect.call(t,s,n),t.onSelect&&t.onSelect(s,n),t},unshift:function(e){if(e instanceof Array)for(var t=0,i=e.length;t<i;t++)this._tabs.unshift(e);else this._tabs.unshift(e);return this._render(),this._tabs.length},push:function(e){if(e instanceof Array)for(var t=0,i=e.length;t<i;t++)this._tabs.push(e);else this._tabs.push(e);return this._render(),this._tabs.length},shift:function(e){for(var t=e||1,i=[],n=0,s=this._tabs.length;n<s&&n<t;n++)i.push(this._tabs.shift());return this._render(),e?i:i[0]},pop:function(e){for(var t=e||1,i=[],n=0,s=this._tabs.length;n<s&&n<t;n++)i.push(this._tabs.pop());return this._render(),e?i:i[0]},splice:function(e,t,i){t=void 0===t?this._tabs.length-e:t;var n=this._tabs.splice(e,t);if(i){i instanceof Array==!1&&(i=[i]);for(var s=0,r=i.length;s<r;s++)this._tabs.splice(e+s,0,i[s])}return this._render(),n},removeTab:function(e){var t=[],i=!0;e instanceof Array==!1&&(i=!1,e=[e]);for(var n=0,s=e.length;n<s;n++){var r="number"==typeof e[n]?e[n]:this.indexOf(e[n]);-1!==r&&t.push(this.splice(r,1))}return i?t:t[0]},indexOf:function(e){if("string"==typeof e){for(var t=-1,i=0,n=this._tabs.length;i<n;i++)if(this._tabs[i].key===e){t=i;break}return t}return this._tabs.indexOf(e)},_create:function(){return this._head=new s.Element("div",{class:"flagrate-tab-head"}).insertTo(this),!0===this._bodyless?this._body=new s.Element:this._body=new s.Element("div",{class:"flagrate-tab-body"}).insertTo(this),this},_render:function(){var e=this;return e._head.update(),e._tabs.forEach(function(t){t._button||(t._button=new r.Button({icon:t.icon,label:t.label,onSelect:e._createOnSelectHandler(t)})),t._button.insertTo(e._head)}),e},_createOnSelectHandler:function(e){var t=this;return function(i){!0===/firefox/i.test(navigator.userAgent)&&(window.event=i),t.select(e)}}}},{"./button":9,"./element":15,"./util":36}],31:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.TextArea=void 0,i.createTextArea=function(e){return new r(e)};var n=e("./util"),s=e("./element"),r=i.TextArea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.regexp=e.regexp||null;var t=e.attribute||{};e.id&&(t.id=e.id),e.placeholder&&(t.placeholder=e.placeholder);var i=new s.Element("textarea",t);return(0,n.extendObject)(i,this),i.addClassName("flagrate flagrate-textarea"),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style),e.icon&&i.setIcon(e.icon),e.value&&i.setValue(e.value),e.isDisabled&&i.disable(),i};r.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this.writeAttribute("disabled",!0),this},enable:function(){return this.removeClassName("flagrate-disabled"),this.writeAttribute("disabled",!1),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},setValue:function(e){return this.value=e,this},getValue:function(){return this.value},setIcon:function(e){return this._iconIdentifier=e,e?this.addClassName("flagrate-icon").setStyle({backgroundImage:"url("+e+")"}):this.removeClassName("flagrate-icon").setStyle({backgroundImage:"none"})},getIcon:function(){return this._iconIdentifier||""},isValid:function(){return this.regexp.test(this.getValue())}}},{"./element":15,"./util":36}],32:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.TextInput=void 0,i.createTextInput=function(e){return new r(e)};var n=e("./util"),s=e("./element"),r=i.TextInput=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.regexp=e.regexp||null;var t=e.attribute||{};e.id&&(t.id=e.id),e.value&&(t.value=e.value),e.placeholder&&(t.placeholder=e.placeholder);var i=new s.Element("input",t);return(0,n.extendObject)(i,this),i.addClassName("flagrate flagrate-textinput"),e.className&&i.addClassName(e.className),e.style&&i.setStyle(e.style),e.icon&&i.setIcon(e.icon),e.isDisabled&&i.disable(),i};r.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this.writeAttribute("disabled",!0),this},enable:function(){return this.removeClassName("flagrate-disabled"),this.writeAttribute("disabled",!1),this},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},setValue:function(e){return this.value=e,this},getValue:function(){return this.value},setIcon:function(e){return this._iconIdentifier=e,e?this.addClassName("flagrate-icon").setStyle({backgroundImage:"url("+e+")"}):this.removeClassName("flagrate-icon").setStyle({backgroundImage:"none"})},getIcon:function(){return this._iconIdentifier||""},isValid:function(){return this.regexp.test(this.getValue())}}},{"./element":15,"./util":36}],33:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Tokenizer=void 0,i.createTokenizer=function(e){return new l(e)};var n=e("./util"),s=e("./element"),r=e("./button"),o=e("./menu"),a=e("./text-input"),l=i.Tokenizer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.values=e.values||[],this.max=e.max||-1,this.tokenize=e.tokenize||e.tokenizeSync||n.identity,e.onChange&&(this.onChange=e.onChange);var t=e.attribute||{};e.id&&(t.id=e.id);var i=new s.Element("div",t);return(0,n.extendObject)(i,this),i.addClassName("flagrate flagrate-tokenizer"),e.className&&i.addClassName(e.className),i._tokens=new s.Element("span").insertTo(i),i._input=new a.TextInput({placeholder:e.placeholder}).insertTo(i),0!==i.values.length&&i._updateTokens(),i.addEventListener("click",i._onClickHandler.bind(i)),i._input.addEventListener("keydown",i._onKeydownHandler.bind(i)),i._input.addEventListener("focus",i._onFocusHandler.bind(i)),i._input.addEventListener("blur",i._onBlurHandler.bind(i)),e.style&&i.setStyle(e.style),e.icon&&i.setIcon(e.icon),e.isDisabled&&i.disable(),i};l.prototype={disable:function(){return this.addClassName("flagrate-disabled"),this._input.disable(),this._updateTokens()},enable:function(){return this.removeClassName("flagrate-disabled"),this._input.enable(),this._updateTokens()},isEnabled:function(){return!this.hasClassName("flagrate-disabled")},setValues:function(e){return this.values=e,this._updateTokens()},getValues:function(){return this.values},removeValues:function(){return this.values=[],this._updateTokens()},removeValue:function(e){return this.values.splice(this.values.indexOf(e),1),this._updateTokens()},setIcon:function(e){return this._iconIdentifier=e,e?this.addClassName("flagrate-icon").setStyle({backgroundImage:"url("+e+")"}):this.removeClassName("flagrate-icon").setStyle({backgroundImage:"none"}),this._updateTokens()},getIcon:function(){return this._iconIdentifier||""},focus:function(){this._input.focus()},_updateTokens:function(){var e=this;e._tokens.update(),e.values.forEach(function(t){var i=void 0;i="string"==typeof t?t:t.label,new r.Button({isDisabled:!1===e.isEnabled(),isRemovableByUser:e.isEnabled(),onRemove:function(){return e.removeValue(t)},label:i}).insertTo(e._tokens)});var t=e.getWidth(),i=null===e.getStyle("border-width")?2:parseInt(e.getStyle("border-width").replace("px",""),10),n=t-(null===e.getStyle("padding-left")?4:parseInt(e.getStyle("padding-left").replace("px",""),10))-(null===e.getStyle("padding-right")?4:parseInt(e.getStyle("padding-right").replace("px",""),10))-e._tokens.getWidth()-(null===e._tokens.getStyle("margin-left")?2:parseInt(e._tokens.getStyle("margin-left").replace("px",""),10))-(null===e._input.getStyle("margin-left")?2:parseInt(e._input.getStyle("margin-left").replace("px",""),10))-(null===e._input.getStyle("padding-left")?2:parseInt(e._input.getStyle("padding-left").replace("px",""),10))-2*i-2;return e._input.style.width=n>30?n+"px":n<-5?"":"100%",e.fire("change"),this},_tokenize:function(){this._candidates=[];var e=this._input.value,t=this.tokenize(e,this._tokenized.bind(this));return void 0!==t&&this._tokenized(t),this._lastTokenizedValue=this._input.value,this},_tokenized:function(e){e instanceof Array==!1&&(e=[e]),this._candidates=[];var t=new o.Menu({onSelect:function(){return t.remove()}});t.style.left=this._input.offsetLeft+"px";for(var i,n,s=0,r=e.length;s<r;s++){if("string"==typeof(i=e[s])){if(""===i)continue;n={label:i}}else n=i;n.onSelect&&(n._onSelect=n.onSelect),n.onSelect=function(e,t){return function(i){(e.max<0||e.max>e.values.length)&&e.values.push(t),e._updateTokens(),e.onChange&&e.onChange(i,this)}}(this,i),this._candidates.push(i),t.push(n)}return this._menu&&this._menu.remove(),0!==this._candidates.length&&(this.insert({top:t}),this._menu=t),this},_onClickHandler:function(){this.focus()},_onKeydownHandler:function(e){var t=this;if(13===e.keyCode&&this._lastTokenizedValue!==this._input.value)return e.stopPropagation(),e.preventDefault(),this._lastTokenizedValue=this._input.value,void this._tokenize();if(this._candidates&&0!==this._candidates.length&&(13!==e.keyCode&&39!==e.keyCode||(e.stopPropagation(),e.preventDefault(),this._input.value="",(this.max<0||this.max>this.values.length)&&this.values.push(this._candidates[0]),this._updateTokens(),this.onChange&&this.onChange(),this._menu&&this._menu.remove())),""===this._input.value&&0!==this.values.length&&8===e.keyCode){e.stopPropagation(),e.preventDefault();var i=this.values.pop();this._input.value="string"==typeof i?i:"string"==typeof i.value?i.value:"",this._updateTokens(),this.onChange&&this.onChange(),this._menu&&this._menu.remove()}setTimeout(function(){if(t.max>-1&&t.max<=t.values.length&&""!==t._input.value)return e.stopPropagation(),void(t._input.value="");t._tokenize()},0)},_onFocusHandler:function(){this._updateTokens(),this._tokenize(),this.addClassName("flagrate-tokenizer-focus")},_onBlurHandler:function(){var e=this;this._input.value="",this._menu&&(this._menu.style.opacity="0",setTimeout(function(){return e._menu.remove()},500)),this.removeClassName("flagrate-tokenizer-focus")}}},{"./button":9,"./element":15,"./menu":18,"./text-input":32,"./util":36}],34:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Toolbar=void 0,i.createToolbar=function(e){return new r(e)};var n=e("./util"),s=e("./element"),r=i.Toolbar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.items||[],i=e.attribute||{};e.id&&(i.id=e.id);var r=new s.Element("div",i);(0,n.extendObject)(r,this),r.addClassName("flagrate flagrate-toolbar"),e.className&&r.addClassName(e.className),e.style&&r.setStyle(e.style);for(var o=0,a=t.length;o<a;o++)r.push(t[o]);return r};r.prototype={push:function(e){if("string"==typeof e)new s.Element("hr").insertTo(this);else if(e instanceof HTMLElement)this.insert(e);else{var t=void 0;e.isBorder?t=new s.Element("hr").insertTo(this):(e.element.isFlagrated||(e.element=s.Element.extend(e.element)),t=s.Element.insertTo(e.element,this)),e.key&&(t.dataset._key=e.key)}return this},getElementByKey:function(e){for(var t=this.childNodes,i=0,n=t.length;i<n;i++)if(t[i].dataset._key===e)return t[i];return null},getElements:function(){return this.childNodes||[]}}},{"./element":15,"./util":36}],35:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Tutorial=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.createTutorial=function(e){return new c(e)};var s=e("./util"),r=e("./element"),o=e("./button"),a=e("./popover"),l=e("./modal"),c=i.Tutorial=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onFinish=s.emptyFunction,this.onAbort=s.emptyFunction,this.onClose=s.emptyFunction,this._steps=[],this._index=0,t.steps&&(this._steps=t.steps),t.index&&(this._index=t.index),t.onFinish&&(this.onFinish=t.onFinish),t.onAbort&&(this.onAbort=t.onAbort),t.onClose&&(this.onClose=t.onClose)}return n(e,[{key:"visible",value:function(){return!!this._popover||!!this._modal||!!this._inStep}},{key:"open",value:function(){return!1===this.visible()&&this._main(),this}},{key:"close",value:function(){return!0===this.visible()&&this._afterStep(this.onClose.bind(this)),this}},{key:"abort",value:function(){return!0===this.visible()&&this._afterStep(this.onAbort.bind(this)),this}},{key:"finish",value:function(){return this._afterStep(this.onFinish.bind(this)),this._index=0,this}},{key:"prev",value:function(){var e=this;return this._afterStep(function(){e._index>0&&--e._index,e._main()}),this}},{key:"next",value:function(){var e=this;return this._afterStep(function(){e._index+1<e._steps.length&&++e._index,e._main()}),this}},{key:"_main",value:function(){this._inStep=!0;var e=this._steps[this._index];if(e.onBeforeStep){if(e.onBeforeStep.length)return e.onBeforeStep.call(this,this._step.bind(this)),this;e.onBeforeStep.call(this)}return this._step(),this}},{key:"_step",value:function(){var e=this,t=this._steps[this._index],i=[];this._index+1>=this._steps.length?i.push({className:"flagrate-tutorial-button-finish",onSelect:function(){e._afterStep(e.finish.bind(e))}}):i.push({className:"flagrate-tutorial-button-next",onSelect:function(){e._afterStep(e.next.bind(e))}}),this._index>0&&i.push({className:"flagrate-tutorial-button-prev",onSelect:function(){e._afterStep(e.prev.bind(e))}}),this._index+1<this._steps.length&&i.push({className:"flagrate-tutorial-button-abort",onSelect:function(){e._afterStep(e.abort.bind(e))}}),i[0].color="@primary";var n=void 0;if("string"==typeof t.target?n=document.querySelector(t.target):!0===r.Element.isElement(t.target)&&(n=t.target),n){var s=new r.Element,c=new r.Element;t.html&&c.insert(t.html).insertTo(s),t.text&&c.insertText(t.text).insertTo(s);var u=new r.Element("footer").insertTo(s);i.forEach(function(e){new o.Button(e).insertTo(u)}),this._popover=new a.Popover({className:"flagrate-tutorial",element:s}),this._popover.open(n)}else this._modal=new l.Modal({disableCloseByMask:!0,disableCloseButton:!0,disableCloseByEsc:!0,className:"flagrate-tutorial",title:t.title,text:t.text,html:t.html,buttons:i}),this._modal.open();return t.onStep&&t.onStep.call(this),this}},{key:"_afterStep",value:function(e){this._inStep=!1;var t=!1;if(this._popover&&(t=!0,this._popover.remove(),delete this._popover),this._modal&&(t=!0,this._modal.close(),delete this._modal),!0===t){var i=this._steps[this._index];if(i.onAfterStep){if(i.onAfterStep.length)return i.onAfterStep.call(this,e),this;i.onAfterStep.call(this)}}return e(),this}}]),e}()},{"./button":9,"./element":15,"./modal":19,"./popover":21,"./util":36}],36:[function(e,t,i){"use strict";function n(e,t){var i=void 0;for(i in t)e[i]=t[i];return e}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.identity=function(e){return e},i.extendObject=n,i.emptyFunction=function(){};var r=i.jsonPointer=void 0;!function(e){function t(e,i,n,r){var o=function(e){return e.replace(/~[01]/g,function(e){switch(e){case"~0":return"~";case"~1":return"/"}throw new Error("Invalid tilde escape: "+e)})}(i.shift());if(/^\d+$/.test(o)&&(o=parseInt(o,10)),0!==i.length){if(r&&"object"!==s(e[o])){if(void 0===n)return n;/^\d+$/.test(i[0])?e[o]=[]:e[o]={}}return t(e[o],i,n,r)}return r?(void 0===n?delete e[o]:e[o]=n,n):e[o]}function i(e,t){if("object"!==(void 0===e?"undefined":s(e)))throw new Error("Invalid input object.");if(""===t)return[];if(!t)throw new Error("Invalid JSON pointer.");var i=t.split("/");if(""!==i.shift())throw new Error("Invalid JSON pointer.");return i}e.get=function(e,n){var s=i(e,n);return 0===s.length?e:t(e,s)},e.set=function(e,r,o){if(""===r&&"object"===(void 0===o?"undefined":s(o)))return n(e,o),o;var a=i(e,r);if(0===a.length)throw new Error("Invalid JSON pointer for set.");return t(e,a,o,!0)}}(r||(i.jsonPointer=r={}))},{}]},{},[5]);
//# sourceMappingURL=kuromaty.min.js.map
